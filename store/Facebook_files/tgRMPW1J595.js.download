;/*FB_PKG_DELIM*/

__d("LSComputeOptimisticThreadCapabilities",["LSArrayGetObjectAt","LSComputeParticipantCapabilities","LSGetViewerFBID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.createArray(),c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[1]=a[0],a})},function(e){return c.forEach(c.db.table(14).fetch([[[a[0],{lt:d[1]}],[a[0],{gt:d[1]}]]]),function(e){var f=e.item;return c.sequence([function(e){return c.storedProcedure(b("LSComputeParticipantCapabilities"),f.contactId,a[0]).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[34]=(d[0].push(d[33]),d[0])}])})},function(a){return d[2]=c.i64.cast([0,1073741823]),d[3]=c.i64.of_int32(d[0].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(a){return d[33]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[0],d[33]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[2]=c.i64.and_(d[2],d[34])}])}):c.resolve()},function(b){return d[4]=c.i64.of_int32(d[0].length),c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?c.sequence([function(b){return c.filter(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(b,e){var a=b.done;b=b.value;return a?d[33]=!1:(e=b.item,d[33]=c.i64.eq(e.contactTypeExact,c.i64.cast([0,16]))?!0:!1)})},function(a){return d[5]=d[33]}]):(e=b.item,d[5]=c.i64.eq(e.threadType,c.i64.cast([0,201]))?!0:!1)})},function(b){return d[7]=c.i64.cast([0,1083495711]),d[8]=c.i64.cast([0,1024]),d[9]=c.i64.cast([0,0]),d[10]=c.i64.cast([0,0]),d[11]=c.i64.cast([0,134217728]),c.filter(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(a,b){var e=a.done;a=a.value;return e?d[12]=!1:(b=a.item,d[12]=c.i64.eq(b.contactReachabilityStatusType,c.i64.cast([0,12]))?!0:!1)})},function(b){return d[14]=c.i64.cast([0,1083495711]),d[15]=c.i64.cast([0,1024]),d[16]=c.i64.cast([0,0]),d[17]=c.i64.cast([0,134217728]),d[18]=c.i64.cast([0,0]),d[19]=c.i64.cast([0,8650752]),d[20]=c.i64.cast([0,1024]),d[21]=c.i64.cast([0,0]),d[22]=c.i64.cast([0,0]),d[23]=c.i64.cast([0,0]),d[32]=d[5]?d[19]:d[14],c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(e=[d[32],c.i64.cast([0,1])],d[24]=e[0],d[25]=e[1],e):(b=a.item,e=[d[32],b.threadType],d[24]=e[0],d[25]=e[1])})},function(a){return d[27]=c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,10]))),d[28]=c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,23]))),d[29]=c.createArray(),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,6]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,6]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,0]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,7]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,7]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,1]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,72]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,72]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,12]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,8]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,8]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,2]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,9]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,9]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,3]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,10]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,10]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,4]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,5]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,5]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,8]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,11]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,11]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,14]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,12]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,12]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,15]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,13]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,13]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,18]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,14]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,14]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,20]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,15]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,15]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,23]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(c.i64.cast([0,3]),void 0)||c.i64.neq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,3]))),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,10]))):c.i64.cast([0,0])),d[29]),d[33]=(d[29].push(c.i64.eq(void 0,void 0)||c.i64.neq(c.i64.and_(c.i64.cast([0,0]),d[2]),c.i64.cast([0,0]))?c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,30]))):c.i64.cast([0,0])),d[29]),d[30]=c.i64.cast([0,0]),d[31]=c.i64.of_int32(d[29].length),c.i64.gt(d[31],c.i64.cast([0,0]))?c.loopAsync(d[31],function(a){return d[33]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],d[33]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[30]=c.i64.add(d[30],d[34])}])}):c.resolve()},function(a){return e[0]=c.i64.and_(d[30],c.i64.and_(c.i64.and_((c.i64.eq(d[25],c.i64.cast([0,1]))?c.i64.eq(d[4],c.i64.cast([0,0])):!0)?c.i64.eq(c.i64.and_(d[24],d[27]),c.i64.cast([0,0]))?d[24]:c.i64.sub(d[24],d[27]):d[24],c.i64.eq(d[25],c.i64.cast([0,2]))?c.i64.eq(c.i64.and_(d[24],d[28]),c.i64.cast([0,0]))?d[24]:c.i64.sub(d[24],d[28]):d[24]),(c.i64.eq(d[25],c.i64.cast([0,1]))?c.i64.neq(d[4],c.i64.cast([0,0])):!1)?d[24]:c.i64.xor(d[24],c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,12]))))))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxComputeOptimisticThreadCapabilitiesStoredProcedure";a.__tables__=["participants","threads","contacts"];e.exports=a}),null);
__d("LSGetFirstAvailableQuickReplyCTAID",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(a){return b.sequence([function(a){return b.sortBy(b.db.table(20).fetch(),[["ctaId","DESC"]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[0]=b.i64.cast([0,1]):(d=a.item,c[0]=b.i64.add(d.ctaId,b.i64.cast([0,1])))})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxGetFirstAvailableQuickReplyCTAIDStoredProcedure";a.__tables__=["quick_reply_ctas"];e.exports=a}),null);
__d("LSInsertQuickReplyCTA",["LSArrayGetObjectAt","LSGetFirstAvailableQuickReplyCTAID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=c.i64.of_int32(a[3].length),c.i64.gt(d[0],c.i64.cast([0,0]))?c.sequence([function(b){return c.forEach(c.db.table(20).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})},function(a){return c.storedProcedure(b("LSGetFirstAvailableQuickReplyCTAID")).then(function(a){return a=a,d[1]=a[0],a})},function(e){return d[2]=d[1],d[3]=c.i64.of_int32(a[3].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(e){return d[7]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[3],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(b){return d[10]=d[8].get("title"),d[11]=d[8].get("type"),d[12]=d[8].get("image_url"),d[13]=d[8].get("platform_token"),c.db.table(20).add({threadKey:a[0],messageId:a[1],ctaId:d[2],messageTimestampMs:a[2],title:d[10],type_:d[11],imageUrl:d[12],platformToken:d[13]})},function(a){return d[2]=c.i64.add(d[2],c.i64.cast([0,1]))}])}):c.resolve()},function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[3],c.i64.cast([0,0])).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(b){return d[6]=d[4].get("quick_reply_type"),c.forEach(c.filter(c.db.table(12).fetch([[[a[0],a[2],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.timestampMs,a[2])&&b.messageId===a[1]}),function(a){var b=a.update;a.item;return b({hasQuickReplies:!0,quickReplyType:d[6]})})}]):c.resolve()},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxInsertQuickReplyCTAStoredProcedure";a.__tables__=["quick_reply_ctas","messages"];e.exports=a}),null);
__d("LSGetLocalizedReplySnippet",["LSGetThreadParticipantDisplayName","LSGetViewerFBID","LSLocalize"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.i64.eq(a[3],c.i64.cast([0,1]))?c.sequence([function(e){return c.i64.eq(a[1],d[0])?c.sequence([function(e){return c.i64.eq(a[2],d[0])?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2421884758]),void 0).then(function(a){return d[4]=a})},function(a){return d[3]=d[4]}]):c.sequence([function(e){return c.storedProcedure(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[4]),d[5]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2676961947]),d[5]).then(function(a){return d[6]=a})},function(a){return d[3]=d[6]}])},function(a){return d[2]=d[3]}]):c.sequence([function(e){return c.storedProcedure(b("LSGetThreadParticipantDisplayName"),a[0],a[1]).then(function(a){return a=a,d[3]=a[0],a})},function(e){return c.i64.eq(a[2],d[0])?c.sequence([function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[3]),d[5]),b("LSLocalize").localizeV2Async(c.i64.cast([0,3298086032]),d[5]).then(function(a){return d[6]=a})},function(a){return d[4]=d[6]}]):c.sequence([function(e){return c.i64.eq(a[1],a[2])?c.sequence([function(a){return d[6]=c.createArray(),d[8]=(d[6].push(d[3]),d[6]),b("LSLocalize").localizeV2Async(c.i64.cast([0,3873263038]),d[6]).then(function(a){return d[7]=a})},function(a){return d[5]=d[7]}]):c.sequence([function(e){return c.storedProcedure(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[7]=c.createArray(),d[9]=(d[7].push(d[3]),d[7]),d[9]=(d[7].push(d[6]),d[7]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2616853333]),d[7]).then(function(a){return d[8]=a})},function(a){return d[5]=d[8]}])},function(a){return d[4]=d[5]}])},function(a){return d[2]=d[4]}])},function(a){return d[1]=d[2]}]):c.sequence([function(e){return c.i64.eq(a[1],d[0])?c.sequence([function(e){return c.i64.eq(a[2],d[0])?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,4002265907]),void 0).then(function(a){return d[4]=a})},function(a){return d[3]=d[4]}]):c.sequence([function(e){return c.storedProcedure(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[4]),d[5]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2663996736]),d[5]).then(function(a){return d[6]=a})},function(a){return d[3]=d[6]}])},function(a){return d[2]=d[3]}]):c.sequence([function(e){return c.storedProcedure(b("LSGetThreadParticipantDisplayName"),a[0],a[1]).then(function(a){return a=a,d[3]=a[0],a})},function(e){return c.i64.eq(a[2],d[0])?c.sequence([function(a){return d[5]=c.createArray(),d[7]=(d[5].push(d[3]),d[5]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2868699317]),d[5]).then(function(a){return d[6]=a})},function(a){return d[4]=d[6]}]):c.sequence([function(e){return c.i64.eq(a[1],a[2])?c.sequence([function(a){return d[6]=c.createArray(),d[8]=(d[6].push(d[3]),d[6]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2688620547]),d[6]).then(function(a){return d[7]=a})},function(a){return d[5]=d[7]}]):c.sequence([function(e){return c.storedProcedure(b("LSGetThreadParticipantDisplayName"),a[0],a[2]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[7]=c.createArray(),d[9]=(d[7].push(d[3]),d[7]),d[9]=(d[7].push(d[6]),d[7]),b("LSLocalize").localizeV2Async(c.i64.cast([0,3544071775]),d[7]).then(function(a){return d[8]=a})},function(a){return d[5]=d[8]}])},function(a){return d[4]=d[5]}])},function(a){return d[2]=d[4]}])},function(a){return d[1]=d[2]}])},function(a){return e[0]=d[1]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxGetLocalizedReplySnippetStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSSetMessageViewFlags",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(d){return b.filter(b.db.table(12).fetch([[[a[0],a[2],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.timestampMs,a[2])&&c.messageId===a[1]}).next().then(function(a,d){var e=a.done;a=a.value;return e?(e=[b.i64.cast([0,0]),b.i64.cast([0,0]),b.i64.cast([0,0]),!1,"nonexistent",b.i64.cast([0,20]),void 0,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8],e):(d=a.item,e=[d.timestampMs,d.senderId,d.viewFlags,d.isAdminMessage,d.messageId,d.authorityLevel,d.stickerId,d.primarySortKey,d.secondarySortKey==null?b.i64.cast([-1,4294967295]):d.secondarySortKey],c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8])})},function(d){return b.sortBy(b.filter(b.db.table(12).fetch([[[a[0],{gt:c[7]}],[a[0],c[7]]],"messageDisplayOrder"]),function(d){return b.i64.eq(d.threadKey,a[0])&&d.messageId!==a[1]&&(b.i64.gt(d.primarySortKey,c[7])||b.i64.eq(d.primarySortKey,c[7])&&b.i64.ge(d.secondarySortKey==null?b.i64.cast([-1,4294967295]):d.secondarySortKey,c[8]))}),[["timestampMs","ASC"]],["primarySortKey","secondarySortKey"]).next().then(function(a,d){var e=a.done;a=a.value;return e?(e=[b.i64.cast([0,0]),b.i64.cast([0,0]),b.i64.cast([0,0]),!1,"nonexistent",b.i64.cast([0,20]),void 0,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[10]=e[0],c[11]=e[1],c[12]=e[2],c[13]=e[3],c[14]=e[4],c[15]=e[5],c[16]=e[6],c[17]=e[7],c[18]=e[8],e):(d=a.item,e=[d.timestampMs,d.senderId,d.viewFlags,d.isAdminMessage,d.messageId,d.authorityLevel,d.stickerId,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[10]=e[0],c[11]=e[1],c[12]=e[2],c[13]=e[3],c[14]=e[4],c[15]=e[5],c[16]=e[6],c[17]=e[7],c[18]=e[8])})},function(d){return b.sortBy(b.filter(b.db.table(12).fetchDesc([[[a[0],{lt:c[7]}],[a[0],c[7]]],"messageDisplayOrder"]),function(d){return b.i64.eq(d.threadKey,a[0])&&d.messageId!==a[1]&&(b.i64.lt(d.primarySortKey,c[7])||b.i64.eq(d.primarySortKey,c[7])&&b.i64.le(d.secondarySortKey==null?b.i64.cast([-1,4294967295]):d.secondarySortKey,c[8]))}),[["timestampMs","DESC"]],["primarySortKey","secondarySortKey"]).next().then(function(a,d){var e=a.done;a=a.value;return e?(e=[b.i64.cast([0,0]),b.i64.cast([0,0]),b.i64.cast([0,0]),!1,"nonexistent",b.i64.cast([0,20]),void 0,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[20]=e[0],c[21]=e[1],c[22]=e[2],c[23]=e[3],c[24]=e[4],c[25]=e[5],c[26]=e[6],c[27]=e[7],c[28]=e[8],e):(d=a.item,e=[d.timestampMs,d.senderId,d.viewFlags,d.isAdminMessage,d.messageId,d.authorityLevel,d.stickerId,b.i64.cast([-1,4294967295]),b.i64.cast([-1,4294967295])],c[20]=e[0],c[21]=e[1],c[22]=e[2],c[23]=e[3],c[24]=e[4],c[25]=e[5],c[26]=e[6],c[27]=e[7],c[28]=e[8])})},function(d){return c[32]=b.i64.or_(b.i64.cast([0,2]),b.i64.or_(!c[3]&&!a[3]?b.i64.cast([0,4]):b.i64.cast([0,0]),b.i64.or_(c[3]?b.i64.cast([0,0]):b.i64.cast([0,1]),b.i64.or_(b.i64.eq(c[5],b.i64.cast([0,60]))||b.i64.eq(c[5],b.i64.cast([0,80]))?b.i64.cast([0,1048576]):b.i64.cast([0,0]),b.i64.neq(c[6],b.i64.cast([85970,924785702]))&&b.i64.neq(c[6],b.i64.cast([85970,1004785694]))&&b.i64.neq(c[6],b.i64.cast([85970,1044785690]))?b.i64.cast([0,0]):b.i64.cast([0,2097152]))))),c[14]!=="nonexistent"?b.sequence([function(d){return c[35]=b.i64.or_(b.i64.and_(c[12],b.i64.cast([-1,4294967280])),b.i64.or_(b.i64.gt(b.i64.sub(c[10],c[0]),b.i64.cast([0,6e5]))?b.i64.cast([0,2]):b.i64.cast([0,0]),b.i64.or_(b.i64.eq(c[11],c[1])&&!c[13]&&!c[3]&&!b.i64.gt(b.i64.sub(c[10],c[0]),b.i64.cast([0,6e5]))?b.i64.cast([0,8]):b.i64.cast([0,0]),b.i64.or_(!a[3]&&!c[13]&&!(b.i64.eq(c[11],c[1])&&!c[13]&&!c[3]&&!b.i64.gt(b.i64.sub(c[10],c[0]),b.i64.cast([0,6e5])))?b.i64.cast([0,4]):b.i64.cast([0,0]),b.i64.and_(c[12],b.i64.cast([0,1])))))),c[33]=b.i64.eq(b.i64.and_(c[35],b.i64.cast([0,8])),b.i64.cast([0,8])),c[34]=c[33]?b.i64.or_(c[32],b.i64.cast([0,16])):c[32],b.forEach(b.filter(b.db.table(12).fetch([[[a[0],c[10],c[14]]]]),function(d){return b.i64.eq(d.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(d.timestampMs,c[10])&&d.messageId===c[14]}),function(a){var b=a.update;a.item;return b({viewFlags:c[35]})})},function(a){return c[30]=c[33]?b.i64.and_(c[34],b.i64.cast([-1,4294967294])):c[34]}]):b.resolve(c[30]=c[32])},function(d){return c[24]!=="nonexistent"?b.sequence([function(d){return c[35]=b.i64.or_(b.i64.and_(c[30],b.i64.cast([-1,4294967280])),b.i64.or_(b.i64.gt(b.i64.sub(c[0],c[20]),b.i64.cast([0,6e5]))?b.i64.cast([0,2]):b.i64.cast([0,0]),b.i64.or_(b.i64.eq(c[1],c[21])&&!c[3]&&!c[23]&&!b.i64.gt(b.i64.sub(c[0],c[20]),b.i64.cast([0,6e5]))?b.i64.cast([0,8]):b.i64.cast([0,0]),b.i64.or_(!a[3]&&!c[3]&&!(b.i64.eq(c[1],c[21])&&!c[3]&&!c[23]&&!b.i64.gt(b.i64.sub(c[0],c[20]),b.i64.cast([0,6e5])))?b.i64.cast([0,4]):b.i64.cast([0,0]),b.i64.and_(c[30],b.i64.cast([0,1])))))),c[33]=b.i64.eq(b.i64.and_(c[35],b.i64.cast([0,8])),b.i64.cast([0,8])),c[34]=c[33]?b.i64.or_(c[22],b.i64.cast([0,16])):c[22],b.forEach(b.filter(b.db.table(12).fetch([[[a[0],c[20],c[24]]]]),function(d){return b.i64.eq(d.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(d.timestampMs,c[20])&&d.messageId===c[24]}),function(a){var d=a.update;a.item;return d({viewFlags:c[33]?b.i64.and_(c[34],b.i64.cast([-1,4294967294])):c[34]})})},function(a){return c[31]=c[35]}]):b.resolve(c[31]=c[30])},function(d){return b.forEach(b.filter(b.db.table(12).fetch([[[a[0],c[0],c[4]]]]),function(d){return b.i64.eq(d.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(d.timestampMs,c[0])&&d.messageId===c[4]}),function(a){var b=a.update;a.item;return b({viewFlags:c[31]})})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxSetMessageViewFlagsStoredProcedure";a.__tables__=["messages"];e.exports=a}),null);
__d("LSLocalApplyOptimisticMessage",["LSCreateOfflineThreadingID","LSGetLocalizedReplySnippet","LSIssueNewError","LSLocalize","LSSetMessageDisplayedContentTypes","LSSetMessageViewFlags"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),void 0!==void 0?c.resolve(d[1]=void 0):c.sequence([function(a){return c.storedProcedure(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[1]=c.i64.to_string(d[9])}])},function(e){return d[8]=a[4]==null?a[3]:a[4],c.sequence([function(a){return c.islc(c.db.table(9).fetchDesc([[[]],"lastActivityTimestampMs"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?d[9]=c.i64.cast([-1,4294967295]):(b=a.item,d[9]=b.lastActivityTimestampMs)})},function(e){return d[11]=c.i64.add(d[9],c.i64.cast([0,1])),d[13]=c.i64.gt(d[0],d[11])?d[0]:d[11],c.db.table(9).fetch([[[a[1]]]]).next().then(function(e,f){f=e.done;e=e.value;return f?c.sequence([function(b){return function(a){c.logger(a).info(a)}("localApplyOptimisticMessage insert optimistic thread"),c.forEach(c.filter(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,40]))}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:a[1],mailboxType:c.i64.cast([0,0]),threadType:a[2],clientThreadKey:a[1],folderName:"inbox",parentThreadKey:c.i64.cast([0,0]),lastActivityTimestampMs:d[13],lastReadWatermarkTimestampMs:d[13],snippet:d[8],snippetHasEmoji:a[5]==null?!1:a[5],snippetSenderContactId:a[0],ongoingCallState:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,40])})},function(b){return c.i64.eq(a[2],c.i64.cast([0,13]))||c.i64.eq(a[2],c.i64.cast([0,7]))||c.i64.eq(a[2],c.i64.cast([0,1]))?c.sequence([function(b){return c.forEach(c.filter(c.db.table(14).fetch([[[a[1],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(14).add({threadKey:a[1],contactId:a[1],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),isModerator:!1})}]):c.resolve()},function(a){return c.sortBy(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[14]=!1:(b=a.item,d[14]=b.errorShouldBeShown)})},function(a){return d[14]===!0?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2285622730]),void 0).then(function(a){return d[16]=a})},function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,1919524925]),void 0).then(function(a){return d[17]=a})},function(a){return c.storedProcedure(b("LSIssueNewError"),void 0,c.i64.cast([0,1545093]),d[16],d[17],void 0,void 0)}]):c.resolve()}]):(e.item,c.forEach(c.filter(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(b.threadType,a[2])}),function(b){var c=b.update;b.item;return c({lastActivityTimestampMs:d[13],lastReadWatermarkTimestampMs:d[13],snippet:d[8],snippetHasEmoji:a[5]==null?!1:a[5],snippetSenderContactId:a[0],snippetText:void 0,snippetStringHash:void 0,snippetStringArgument1:void 0,snippetAttribution:void 0,snippetAttributionStringHash:void 0,additionalThreadContext:void 0})}))})}])},function(e){return c.sequence([function(b){return c.islc(c.db.table(12).fetchDesc([[[a[1],c.i64.cast([0,80])],[a[1],c.i64.cast([0,60])],[a[1],c.i64.cast([0,40])]],"messageDisplayOrderAuthority"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[33]=c.i64.of_float(Date.now()),d[9]=d[33]):(b=a.item,d[9]=b.primarySortKey)})},function(e){return a[8]!==void 0&&(c.i64.eq(a[9],c.i64.cast([0,1]))||c.i64.eq(a[10],c.i64.cast([0,1])))?c.sequence([function(e){return c.filter(c.db.table(12).fetch([[[a[8]==null?"":a[8]]],"messageId"]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===(a[8]==null?"":a[8])}).next().then(function(e,f){var g=e.done;e=e.value;return g?(g=[a[8],void 0,void 0,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[33]=g[0],d[34]=g[1],d[35]=g[2],d[36]=g[3],d[37]=g[4],d[38]=g[5],d[39]=g[6],d[40]=g[7],d[41]=g[8],d[42]=g[9],d[43]=g[10],d[44]=g[11],d[45]=g[12],d[46]=g[13],d[47]=g[14],d[48]=g[15],g):(f=e.item,c.sequence([function(e){return d[54]=f.senderId,d[53]=f.stickerId,c.i64.neq(d[53],void 0)?(e=[d[53],c.i64.cast([0,4])],d[56]=e[0],d[57]=e[1],e):(e=[void 0,void 0],d[56]=e[0],d[57]=e[1],e),e=[d[56],d[57]],d[50]=e[0],d[51]=e[1],d[55]=f.replyType==null?c.i64.cast([0,0]):f.replyType,c.sequence([function(e){return c.storedProcedure(b("LSGetLocalizedReplySnippet"),a[1],a[0],d[54],d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(b){return d[52]=c.i64.eq(a[10],c.i64.cast([0,1]))?d[56]:""}])},function(b){return b=[a[8],a[9],a[10],c.i64.cast([0,1]),d[52],d[54],f.text,d[50],d[51],void 0,void 0,void 0,void 0,void 0,void 0,d[55]],d[33]=b[0],d[34]=b[1],d[35]=b[2],d[36]=b[3],d[37]=b[4],d[38]=b[5],d[39]=b[6],d[40]=b[7],d[41]=b[8],d[42]=b[9],d[43]=b[10],d[44]=b[11],d[45]=b[12],d[46]=b[13],d[47]=b[14],d[48]=b[15],b}]))})},function(a){return a=[d[33],d[34],d[35],d[36],d[37],d[38],d[39],d[40],d[41],d[42],d[43],d[44],d[45],d[46],d[47],d[48]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4],d[16]=a[5],d[17]=a[6],d[18]=a[7],d[19]=a[8],d[20]=a[9],d[21]=a[10],d[22]=a[11],d[23]=a[12],d[24]=a[13],d[25]=a[14],d[26]=a[15],a}]):c.resolve((a[8]===void 0||c.i64.eq(a[9],c.i64.cast([0,0]))||c.i64.eq(a[10],c.i64.cast([0,0]))?(e=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[33]=e[0],d[34]=e[1],d[35]=e[2],d[36]=e[3],d[37]=e[4],d[38]=e[5],d[39]=e[6],d[40]=e[7],d[41]=e[8],d[42]=e[9],d[43]=e[10],d[44]=e[11],d[45]=e[12],d[46]=e[13],d[47]=e[14],d[48]=e[15],e):(e=[a[8],a[9],a[10],c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[33]=e[0],d[34]=e[1],d[35]=e[2],d[36]=e[3],d[37]=e[4],d[38]=e[5],d[39]=e[6],d[40]=e[7],d[41]=e[8],d[42]=e[9],d[43]=e[10],d[44]=e[11],d[45]=e[12],d[46]=e[13],d[47]=e[14],d[48]=e[15],e),e=[d[33],d[34],d[35],d[36],d[37],d[38],d[39],d[40],d[41],d[42],d[43],d[44],d[45],d[46],d[47],d[48]],d[11]=e[0],d[12]=e[1],d[13]=e[2],d[14]=e[3],d[15]=e[4],d[16]=e[5],d[17]=e[6],d[18]=e[7],d[19]=e[8],d[20]=e[9],d[21]=e[10],d[22]=e[11],d[23]=e[12],d[24]=e[13],d[25]=e[14],d[26]=e[15]))},function(b){return a[13]?d[27]=!1:d[27]=!0,d[27]?(b=[void 0,void 0,void 0,void 0],d[28]=b[0],d[29]=b[1],d[30]=b[2],d[31]=b[3],b):(d[33]=a[13].get("mention_offsets"),d[34]=a[13].get("mention_lengths"),d[35]=a[13].get("mention_ids"),d[36]=a[13].get("mention_types"),b=[d[33],d[34],d[35],d[36]],d[28]=b[0],d[29]=b[1],d[30]=b[2],d[31]=b[3]),a[11]?d[32]=c.i64.cast([0,3]):d[32]=d[13],c.i64.eq(c.i64.cast([0,20]),c.i64.cast([0,20]))?c.db.table(12).add({threadKey:a[1],messageId:d[1],timestampMs:d[0],offlineThreadingId:d[1],primarySortKey:d[9],secondarySortKey:d[0],text:a[3],senderId:a[0],stickerId:a[6],hotEmojiSize:a[7],isForwarded:a[11],forwardScore:a[12],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[32],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],replyType:d[26],mentionOffsets:d[28],mentionLengths:d[29],mentionIds:d[30],mentionTypes:d[31]}):c.sequence([function(a){return c.db.table(12).fetch([[[d[1]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[d[9],d[0],void 0],d[33]=c[0],d[34]=c[1],d[35]=c[2],c):(b=a.item,c=[b.primarySortKey,b.secondarySortKey,b.localDataId],d[33]=c[0],d[34]=c[1],d[35]=c[2])})},function(a){return c.forEach(c.filter(c.db.table(12).fetch([[[d[1]]],"optimistic"]),function(a){return a.offlineThreadingId===d[1]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(12).add({threadKey:a[1],messageId:d[1],timestampMs:d[0],offlineThreadingId:d[1],primarySortKey:d[33],secondarySortKey:d[34],text:a[3],senderId:a[0],stickerId:a[6],hotEmojiSize:a[7],isForwarded:a[11],forwardScore:a[12],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),localDataId:d[35],replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[32],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],replyType:d[26],mentionOffsets:d[28],mentionLengths:d[29],mentionIds:d[30],mentionTypes:d[31]})}])}])},function(e){return d[2]=c.createArray(),d[3]=(d[2].push("LSMailboxLocalApplyOptimisticMessageStoredProcedure"),d[2]),d[4]=(d[2].push("localApplyOptimisticMessage"),d[2]),d[5]=(d[2].push(a[1]),d[2]),d[6]=(d[2].push(d[1]),d[2]),d[7]=c.toJSON(d[2]),function(a){c.logger(a).info(a)}(d[7]),a[14]?c.sequence([function(e){return c.storedProcedure(b("LSSetMessageViewFlags"),a[1],d[1],d[0],c.i64.eq(a[2],c.i64.cast([0,1])))},function(e){return c.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],d[1],d[0],a[3],!1,c.i64.neq(a[6],void 0))}]):c.resolve()},function(a){return a=[d[1],d[0]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticMessageStoredProcedure";a.__tables__=["threads","participants","user_visible_network_connectivity_error","messages"];e.exports=a}),null);
__d("LSLocalApplyOptimisticGroupThread",["LSArrayGetObjectAt","LSCreateOfflineThreadingID","LSDeserializeFromJsonIntoDictionaryV2.nop","LSGetViewerFBID","LSInsertQuickReplyCTA","LSIssueNewTask","LSLocalApplyOptimisticMessage"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[1]=a[0],a})},function(e){return a[3]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[3]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[20]=new c.Map(),d[26]="product_type",d[21]=d[19].get(d[26]),d[21]!==void 0?d[20].set(d[26],d[21]):0,d[27]="product_extras",d[22]=d[19].get(d[27]),d[22]?d[23]=!1:d[23]=!0,d[23]?c.resolve():c.sequence([function(a){return d[22]?d[28]=!1:d[28]=!0,d[28]?c.resolve(d[29]=void 0):c.sequence([function(a){return d[30]=d[22].get("__typename"),d[30]==="XMSGStoryReplyExtras"?c.resolve((d[32]=new c.Map(),d[35]="logging",d[33]=d[22].get(d[35]),d[33]?d[34]=!1:d[34]=!0,d[34]?0:(d[33]?d[36]=!1:d[36]=!0,d[36]?d[37]=void 0:(d[38]=new c.Map(),d[46]="story_author_fbid",d[39]=d[33].get(d[46]),d[39]!==void 0?d[38].set(d[46],d[39]):0,d[47]="camera_post_type",d[40]=d[33].get(d[47]),d[40]!==void 0?d[38].set(d[47],d[40]):0,d[48]="story_type",d[41]=d[33].get(d[48]),d[41]!==void 0?d[38].set(d[48],d[41]):0,d[49]="post_source",d[42]=d[33].get(d[49]),d[42]!==void 0?d[38].set(d[49],d[42]):0,d[50]="fb_post_type",d[43]=d[33].get(d[50]),d[43]!==void 0?d[38].set(d[50],d[43]):0,d[51]="conversation_starter_type",d[44]=d[33].get(d[51]),d[44]!==void 0?d[38].set(d[51],d[44]):0,d[52]="story_reply_type",d[45]=d[33].get(d[52]),d[45]!==void 0?d[38].set(d[52],d[45]):0,d[37]=d[38]),d[32].set(d[35],d[37])),d[31]=d[32])):c.sequence([function(a){return d[30]==="XMSGMarketplaceExtras"?c.sequence([function(a){return d[33]=new c.Map(),d[52]="listing_id",d[34]=d[22].get(d[52]),d[34]!==void 0?d[33].set(d[52],d[34]):0,d[53]="initial_clicked_component",d[35]=d[22].get(d[53]),d[35]!==void 0?d[33].set(d[53],d[35]):0,d[54]="initial_tracking",d[36]=d[22].get(d[54]),d[36]!==void 0?d[33].set(d[54],d[36]):0,d[55]="referral_surface",d[37]=d[22].get(d[55]),d[37]!==void 0?d[33].set(d[55],d[37]):0,d[56]="referral_story_type",d[38]=d[22].get(d[56]),d[38]!==void 0?d[33].set(d[56],d[38]):0,d[57]="referral_ui_component",d[39]=d[22].get(d[57]),d[39]!==void 0?d[33].set(d[57],d[39]):0,d[58]="surface",d[40]=d[22].get(d[58]),d[40]!==void 0?d[33].set(d[58],d[40]):0,d[59]="tracking",d[41]=d[22].get(d[59]),d[41]!==void 0?d[33].set(d[59],d[41]):0,d[60]="ui_component",d[42]=d[22].get(d[60]),d[42]!==void 0?d[33].set(d[60],d[42]):0,d[61]="ad_id",d[43]=d[22].get(d[61]),d[43]!==void 0?d[33].set(d[61],d[43]):0,d[62]="server_session_id",d[44]=d[22].get(d[62]),d[44]!==void 0?d[33].set(d[62],d[44]):0,d[63]="cf_page_id",d[45]=d[22].get(d[63]),d[45]!==void 0?d[33].set(d[63],d[45]):0,d[64]="live_shopping_video_id",d[46]=d[22].get(d[64]),d[46]!==void 0?d[33].set(d[64],d[46]):0,d[65]="logging_id",d[47]=d[22].get(d[65]),c.i64.neq(d[47],void 0)?d[33].set(d[65],d[47]):0,d[66]="photo_ids",d[48]=d[22].get(d[66]),d[48]?d[49]=!1:d[49]=!0,d[49]?c.resolve():c.sequence([function(a){return d[69]=c.createArray(),d[70]=c.i64.of_int32(d[48].length),c.i64.gt(d[70],c.i64.cast([0,0]))?c.loopAsync(d[70],function(a){return d[71]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[48],d[71]).then(function(a){return a=a,d[72]=a[0],d[73]=a[1],a})},function(a){return d[74]=(d[69].push(d[72]),d[69])}])}):c.resolve()},function(a){return d[33].set(d[66],d[69])}])},function(a){return d[67]="is_customized_message",d[50]=d[22].get(d[67]),d[50]!==void 0?d[33].set(d[67],d[50]):0,d[68]="referral_code",d[51]=d[22].get(d[68]),d[51]!==void 0?d[33].set(d[68],d[51]):0,d[32]=d[33]}]):c.sequence([function(a){return d[30]==="XMSGClickToMessengerAdExtras"?c.resolve((d[34]=new c.Map(),d[45]="encrypted_ads_token",d[35]=d[22].get(d[45]),d[35]!==void 0?d[34].set(d[45],d[35]):0,d[46]="product_type",d[36]=d[22].get(d[46]),d[36]!==void 0?d[34].set(d[46],d[36]):0,d[47]="post_id",d[37]=d[22].get(d[47]),d[37]!==void 0?d[34].set(d[47],d[37]):0,d[48]="ad_id",d[38]=d[22].get(d[48]),d[38]!==void 0?d[34].set(d[48],d[38]):0,d[49]="page_id",d[39]=d[22].get(d[49]),d[39]!==void 0?d[34].set(d[49],d[39]):0,d[50]="photo_id",d[40]=d[22].get(d[50]),d[40]!==void 0?d[34].set(d[50],d[40]):0,d[51]="photo_index",d[41]=d[22].get(d[51]),c.i64.neq(d[41],void 0)?d[34].set(d[51],d[41]):0,d[52]="fallback_url",d[42]=d[22].get(d[52]),d[42]!==void 0?d[34].set(d[52],d[42]):0,d[53]="product_id",d[43]=d[22].get(d[53]),d[43]!==void 0?d[34].set(d[53],d[43]):0,d[54]="user_id",d[44]=d[22].get(d[54]),d[44]!==void 0?d[34].set(d[54],d[44]):0,d[33]=d[34])):c.sequence([function(a){return d[30]==="XMSGZorroMessageExtras"?c.resolve((d[35]=new c.Map(),d[37]="is_enabled",d[36]=d[22].get(d[37]),d[36]!==void 0?d[35].set(d[37],d[36]):0,d[34]=d[35])):c.sequence([function(a){return d[30]==="XMSGGenAISuggestedPromptExtras"?c.resolve((d[36]=new c.Map(),d[39]="prompt_type",d[37]=d[22].get(d[39]),d[37]!==void 0?d[36].set(d[39],d[37]):0,d[40]="qpl_join_id",d[38]=d[22].get(d[40]),d[38]!==void 0?d[36].set(d[40],d[38]):0,d[35]=d[36])):c.sequence([function(a){return d[30]==="XMSGGenAIMultiModalExtras"?c.resolve((d[37]=new c.Map(),d[41]="should_skip_genai_eval",d[38]=d[22].get(d[41]),d[38]!==void 0?d[37].set(d[41],d[38]):0,d[42]="associated_multimodal_message_id",d[39]=d[22].get(d[42]),d[39]!==void 0?d[37].set(d[42],d[39]):0,d[43]="qpl_join_id",d[40]=d[22].get(d[43]),d[40]!==void 0?d[37].set(d[43],d[40]):0,d[36]=d[37])):c.sequence([function(a){return d[30]==="XMSGGenAIFlashImagineExtras"?c.resolve((d[38]=new c.Map(),d[41]="seed",d[39]=d[22].get(d[41]),c.i64.neq(d[39],void 0)?d[38].set(d[41],d[39]):0,d[42]="qpl_join_id",d[40]=d[22].get(d[42]),d[40]!==void 0?d[38].set(d[42],d[40]):0,d[37]=d[38])):c.sequence([function(a){return d[30]==="XMSGShareSheetExtras"?c.resolve((d[39]=new c.Map(),d[41]="recipient_selection_session_id",d[40]=d[22].get(d[41]),d[40]!==void 0?d[39].set(d[41],d[40]):0,d[38]=d[39])):c.sequence([function(a){return d[30]==="XMSGGenAIAssistantAPIExtras"?c.sequence([function(a){return d[40]=new c.Map(),d[76]="referrer_session_id",d[41]=d[22].get(d[76]),d[41]!==void 0?d[40].set(d[76],d[41]):0,d[77]="thread_session_id",d[42]=d[22].get(d[77]),d[42]!==void 0?d[40].set(d[77],d[42]):0,d[78]="prompt_id",d[43]=d[22].get(d[78]),d[43]!==void 0?d[40].set(d[78],d[43]):0,d[79]="prompt_type",d[44]=d[22].get(d[79]),d[44]!==void 0?d[40].set(d[79],d[44]):0,d[80]="prompt_fit_topic",d[45]=d[22].get(d[80]),d[45]!==void 0?d[40].set(d[80],d[45]):0,d[81]="location_extras",d[46]=d[22].get(d[81]),d[46]?d[47]=!1:d[47]=!0,d[47]?0:(d[46]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[108]="has_previous_perm_prompt",d[105]=d[46].get(d[108]),d[105]!==void 0?d[104].set(d[108],d[105]):0,d[109]="latitude",d[106]=d[46].get(d[109]),d[106]!==void 0?d[104].set(d[109],d[106]):0,d[110]="longitude",d[107]=d[46].get(d[110]),d[107]!==void 0?d[104].set(d[110],d[107]):0,d[103]=d[104]),d[40].set(d[81],d[103])),d[82]="qpl_join_id",d[48]=d[22].get(d[82]),d[48]!==void 0?d[40].set(d[82],d[48]):0,d[83]="meta_ai_prompt_type",d[49]=d[22].get(d[83]),d[49]!==void 0?d[40].set(d[83],d[49]):0,d[84]="is_subsequent_send",d[50]=d[22].get(d[84]),d[50]!==void 0?d[40].set(d[84],d[50]):0,d[85]="context_injection_type",d[51]=d[22].get(d[85]),d[51]!==void 0?d[40].set(d[85],d[51]):0,d[86]="context_injection_timestamp_ms",d[52]=d[22].get(d[86]),d[52]!==void 0?d[40].set(d[86],d[52]):0,d[87]="meta_ai_response_to_persist",d[53]=d[22].get(d[87]),d[53]?d[54]=!1:d[54]=!0,d[54]?c.resolve():c.sequence([function(a){return d[53]?d[102]=!1:d[102]=!0,d[102]?c.resolve(d[103]=void 0):c.sequence([function(a){return d[104]=new c.Map(),d[111]="text",d[105]=d[53].get(d[111]),d[105]!==void 0?d[104].set(d[111],d[105]):0,d[112]="bot_response_id",d[106]=d[53].get(d[112]),d[106]!==void 0?d[104].set(d[112],d[106]):0,d[113]="bot_request_id",d[107]=d[53].get(d[113]),d[107]!==void 0?d[104].set(d[113],d[107]):0,d[114]="external_search_params",d[108]=d[53].get(d[114]),d[108]?d[109]=!1:d[109]=!0,d[109]?c.resolve():c.sequence([function(a){return d[108]?d[116]=!1:d[116]=!0,d[116]?c.resolve(d[117]=void 0):c.sequence([function(a){return d[118]=new c.Map(),d[126]="search_result_uri",d[119]=d[108].get(d[126]),d[119]?d[120]=!1:d[120]=!0,d[120]?c.resolve():c.sequence([function(a){return d[119]?d[131]=!1:d[131]=!0,d[131]?c.resolve(d[132]=void 0):c.sequence([function(a){return d[133]=c.createArray(),d[134]=c.i64.of_int32(d[119].length),c.i64.gt(d[134],c.i64.cast([0,0]))?c.loopAsync(d[134],function(a){return d[135]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[119],d[135]).then(function(a){return a=a,d[136]=a[0],d[137]=a[1],a})},function(a){return d[138]=(d[133].push(d[136]),d[133])}])}):c.resolve()},function(a){return d[132]=d[133]}])},function(a){return d[118].set(d[126],d[132])}])},function(a){return d[127]="search_query",d[121]=d[108].get(d[127]),d[121]!==void 0?d[118].set(d[127],d[121]):0,d[128]="attribution_link",d[122]=d[108].get(d[128]),d[122]!==void 0?d[118].set(d[128],d[122]):0,d[129]="search_engine",d[123]=d[108].get(d[129]),d[123]!==void 0?d[118].set(d[129],d[123]):0,d[130]="references_title",d[124]=d[108].get(d[130]),d[124]?d[125]=!1:d[125]=!0,d[125]?c.resolve():c.sequence([function(a){return d[124]?d[131]=!1:d[131]=!0,d[131]?c.resolve(d[132]=void 0):c.sequence([function(a){return d[133]=c.createArray(),d[134]=c.i64.of_int32(d[124].length),c.i64.gt(d[134],c.i64.cast([0,0]))?c.loopAsync(d[134],function(a){return d[135]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[124],d[135]).then(function(a){return a=a,d[136]=a[0],d[137]=a[1],a})},function(a){return d[138]=(d[133].push(d[136]),d[133])}])}):c.resolve()},function(a){return d[132]=d[133]}])},function(a){return d[118].set(d[130],d[132])}])},function(a){return d[117]=d[118]}])},function(a){return d[104].set(d[114],d[117])}])},function(a){return d[115]="followup_prompt_text",d[110]=d[53].get(d[115]),d[110]!==void 0?d[104].set(d[115],d[110]):0,d[103]=d[104]}])},function(a){return d[40].set(d[87],d[103])}])},function(a){return d[88]="gql_dark_test_qpl_join_id",d[55]=d[22].get(d[88]),d[55]!==void 0?d[40].set(d[88],d[55]):0,d[89]="gql_dark_test_client_start_time",d[56]=d[22].get(d[89]),d[56]!==void 0?d[40].set(d[89],d[56]):0,d[90]="prompt_context",d[57]=d[22].get(d[90]),d[57]?d[58]=!1:d[58]=!0,d[58]?0:(d[57]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[107]="context_token",d[105]=d[57].get(d[107]),d[105]!==void 0?d[104].set(d[107],d[105]):0,d[108]="context_token_type",d[106]=d[57].get(d[108]),c.i64.neq(d[106],void 0)?d[104].set(d[108],d[106]):0,d[103]=d[104]),d[40].set(d[90],d[103])),d[91]="imagine_flash_extras",d[59]=d[22].get(d[91]),d[59]?d[60]=!1:d[60]=!0,d[60]?0:(d[59]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[107]="seed",d[105]=d[59].get(d[107]),c.i64.neq(d[105],void 0)?d[104].set(d[107],d[105]):0,d[108]="qpl_join_id",d[106]=d[59].get(d[108]),d[106]!==void 0?d[104].set(d[108],d[106]):0,d[103]=d[104]),d[40].set(d[91],d[103])),d[92]="conversation_marker_id",d[61]=d[22].get(d[92]),d[61]!==void 0?d[40].set(d[92],d[61]):0,d[93]="multi_modal_extras",d[62]=d[22].get(d[93]),d[62]?d[63]=!1:d[63]=!0,d[63]?0:(d[62]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[108]="should_skip_genai_eval",d[105]=d[62].get(d[108]),d[105]!==void 0?d[104].set(d[108],d[105]):0,d[109]="associated_multimodal_message_id",d[106]=d[62].get(d[109]),d[106]!==void 0?d[104].set(d[109],d[106]):0,d[110]="qpl_join_id",d[107]=d[62].get(d[110]),d[107]!==void 0?d[104].set(d[110],d[107]):0,d[103]=d[104]),d[40].set(d[93],d[103])),d[94]="ads_extras",d[64]=d[22].get(d[94]),d[64]?d[65]=!1:d[65]=!0,d[65]?0:(d[64]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[108]="context",d[105]=d[64].get(d[108]),d[105]!==void 0?d[104].set(d[108],d[105]):0,d[109]="is_reply_to_ads_ai",d[106]=d[64].get(d[109]),d[106]!==void 0?d[104].set(d[109],d[106]):0,d[110]="is_message_processed_by_lightspeed",d[107]=d[64].get(d[110]),d[107]!==void 0?d[104].set(d[110],d[107]):0,d[103]=d[104]),d[40].set(d[94],d[103])),d[95]="suggested_prompt_extras",d[66]=d[22].get(d[95]),d[66]?d[67]=!1:d[67]=!0,d[67]?0:(d[66]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[107]="prompt_type",d[105]=d[66].get(d[107]),d[105]!==void 0?d[104].set(d[107],d[105]):0,d[108]="qpl_join_id",d[106]=d[66].get(d[108]),d[106]!==void 0?d[104].set(d[108],d[106]):0,d[103]=d[104]),d[40].set(d[95],d[103])),d[96]="disable_server_mqtt_typing_indicator",d[68]=d[22].get(d[96]),d[68]!==void 0?d[40].set(d[96],d[68]):0,d[97]="enable_web_scraping",d[69]=d[22].get(d[97]),d[69]!==void 0?d[40].set(d[97],d[69]):0,d[98]="client_prompt_timestamp",d[70]=d[22].get(d[98]),d[70]!==void 0?(d[70]!==void 0?d[102]=c.i64.from_string(d[70]):d[102]=void 0,d[40].set(d[98],d[102])):0,d[99]="is_client_ready_for_psi",d[71]=d[22].get(d[99]),d[71]!==void 0?d[40].set(d[99],d[71]):0,d[100]="intent_detection_extras",d[72]=d[22].get(d[100]),d[72]?d[73]=!1:d[73]=!0,d[73]?c.resolve():c.sequence([function(a){return d[72]?d[102]=!1:d[102]=!0,d[102]?c.resolve(d[103]=void 0):c.sequence([function(a){return d[104]=new c.Map(),d[113]="intent_messages_metadata",d[105]=d[72].get(d[113]),d[105]?d[106]=!1:d[106]=!0,d[106]?c.resolve():c.sequence([function(a){return d[105]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[105].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[105],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=new c.Map(),d[132]="message_type",d[125]=d[122].get(d[132]),d[125]!==void 0?d[124].set(d[132],d[125]):0,d[133]="message_sender_name",d[126]=d[122].get(d[133]),d[126]!==void 0?d[124].set(d[133],d[126]):0,d[134]="message_invoker_name",d[127]=d[122].get(d[134]),d[127]!==void 0?d[124].set(d[134],d[127]):0,d[135]="message_timestamp_ms",d[128]=d[122].get(d[135]),d[128]!==void 0?d[124].set(d[135],c.i64.from_string(d[128])):0,d[136]="message_thread_name",d[129]=d[122].get(d[136]),d[129]!==void 0?d[124].set(d[136],d[129]):0,d[137]="message_id",d[130]=d[122].get(d[137]),d[130]!==void 0?d[124].set(d[137],d[130]):0,d[138]="message_text",d[131]=d[122].get(d[138]),d[131]!==void 0?d[124].set(d[138],d[131]):0,d[139]=(d[119].push(d[124]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[113],d[118])}])},function(a){return d[114]="intent_types",d[107]=d[72].get(d[114]),d[107]?d[108]=!1:d[108]=!0,d[108]?c.resolve():c.sequence([function(a){return d[107]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[107].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[107],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=(d[119].push(d[122]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[114],d[118])}])},function(a){return d[115]="intent_message_ids",d[109]=d[72].get(d[115]),d[109]?d[110]=!1:d[110]=!0,d[110]?c.resolve():c.sequence([function(a){return d[109]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[109].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[109],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=(d[119].push(d[122]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[115],d[118])}])},function(a){return d[116]="intent_messages",d[111]=d[72].get(d[116]),d[111]?d[112]=!1:d[112]=!0,d[112]?c.resolve():c.sequence([function(a){return d[111]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[111].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[111],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=(d[119].push(d[122]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[116],d[118])}])},function(a){return d[103]=d[104]}])},function(a){return d[40].set(d[100],d[103])}])},function(a){return d[101]="psi_tool_query_data",d[74]=d[22].get(d[101]),d[74]?d[75]=!1:d[75]=!0,d[75]?c.resolve():c.sequence([function(a){return d[74]?d[102]=!1:d[102]=!0,d[102]?c.resolve(d[103]=void 0):c.sequence([function(a){return d[104]=new c.Map(),d[110]="conversation_name",d[105]=d[74].get(d[110]),d[105]!==void 0?d[104].set(d[110],d[105]):0,d[111]="original_query_string",d[106]=d[74].get(d[111]),d[106]!==void 0?d[104].set(d[111],d[106]):0,d[112]="response_message_id",d[107]=d[74].get(d[112]),d[107]!==void 0?d[104].set(d[112],d[107]):0,d[113]="messages",d[108]=d[74].get(d[113]),d[108]?d[109]=!1:d[109]=!0,d[109]?c.resolve():c.sequence([function(a){return d[108]?d[114]=!1:d[114]=!0,d[114]?c.resolve(d[115]=void 0):c.sequence([function(a){return d[116]=c.createArray(),d[117]=c.i64.of_int32(d[108].length),c.i64.gt(d[117],c.i64.cast([0,0]))?c.loopAsync(d[117],function(a){return d[118]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[108],d[118]).then(function(a){return a=a,d[119]=a[0],d[120]=a[1],a})},function(a){return d[121]=new c.Map(),d[129]="message_type",d[122]=d[119].get(d[129]),d[122]!==void 0?d[121].set(d[129],d[122]):0,d[130]="message_sender_name",d[123]=d[119].get(d[130]),d[123]!==void 0?d[121].set(d[130],d[123]):0,d[131]="message_invoker_name",d[124]=d[119].get(d[131]),d[124]!==void 0?d[121].set(d[131],d[124]):0,d[132]="message_timestamp_ms",d[125]=d[119].get(d[132]),d[125]!==void 0?d[121].set(d[132],c.i64.from_string(d[125])):0,d[133]="message_thread_name",d[126]=d[119].get(d[133]),d[126]!==void 0?d[121].set(d[133],d[126]):0,d[134]="message_id",d[127]=d[119].get(d[134]),d[127]!==void 0?d[121].set(d[134],d[127]):0,d[135]="message_text",d[128]=d[119].get(d[135]),d[128]!==void 0?d[121].set(d[135],d[128]):0,d[136]=(d[116].push(d[121]),d[116])}])}):c.resolve()},function(a){return d[115]=d[116]}])},function(a){return d[104].set(d[113],d[115])}])},function(a){return d[103]=d[104]}])},function(a){return d[40].set(d[101],d[103])}])},function(a){return d[39]=d[40]}]):c.sequence([function(a){return d[30]==="XMSGProductHighlightExtras"?c.resolve((d[41]=new c.Map(),d[44]="product_highlight_type",d[42]=d[22].get(d[44]),d[42]!==void 0?d[41].set(d[44],d[42]):0,d[45]="conversation_marker",d[43]=d[22].get(d[45]),d[43]!==void 0?d[41].set(d[45],d[43]):0,d[40]=d[41])):c.sequence([function(a){return d[30]==="XMSGMagicMessengerExtras"?c.resolve((d[42]=new c.Map(),d[44]="is_magic_thread",d[43]=d[22].get(d[44]),d[43]!==void 0?d[42].set(d[44],d[43]):0,d[41]=d[42])):c.sequence([function(a){return d[30]==="XMSGAdsAIExtras"?c.resolve((d[43]=new c.Map(),d[47]="context",d[44]=d[22].get(d[47]),d[44]!==void 0?d[43].set(d[47],d[44]):0,d[48]="is_reply_to_ads_ai",d[45]=d[22].get(d[48]),d[45]!==void 0?d[43].set(d[48],d[45]):0,d[49]="is_message_processed_by_lightspeed",d[46]=d[22].get(d[49]),d[46]!==void 0?d[43].set(d[49],d[46]):0,d[42]=d[43])):c.sequence([function(a){return d[30]==="XMSGBizappExtras"?c.resolve((d[44]=new c.Map(),d[47]="message_source",d[45]=d[22].get(d[47]),d[45]!==void 0?d[44].set(d[47],d[45]):0,d[48]="message_trigger",d[46]=d[22].get(d[48]),d[46]!==void 0?d[44].set(d[48],d[46]):0,d[43]=d[44])):c.sequence([function(a){return d[44]=new c.Map(),d[45]=d[22].keys(),d[46]=c.i64.of_int32(d[45].length),c.i64.gt(d[46],c.i64.cast([0,0]))?c.loopAsync(d[46],function(a){return d[47]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[45],d[47]).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],a})},function(a){return d[50]=d[22].get(d[48]),d[44].set(d[48],d[50])}])}):c.resolve()},function(a){return d[43]=d[44]}])},function(a){return d[42]=d[43]}])},function(a){return d[41]=d[42]}])},function(a){return d[40]=d[41]}])},function(a){return d[39]=d[40]}])},function(a){return d[38]=d[39]}])},function(a){return d[37]=d[38]}])},function(a){return d[36]=d[37]}])},function(a){return d[35]=d[36]}])},function(a){return d[34]=d[35]}])},function(a){return d[33]=d[34]}])},function(a){return d[32]=d[33]}])},function(a){return d[31]=d[32]}])},function(a){return d[31].set("__typename",d[30]),d[29]=d[31]}])},function(a){return d[20].set(d[27],d[29])}])},function(a){return d[24]=d[20].get("product_extras"),d[24]!==void 0?(d[28]=d[24].get("__typename"),d[28]==="XMSGClickToMessengerAdExtras"?(d[31]=new c.Map(),d[42]="encrypted_ads_token",d[32]=d[24].get(d[42]),d[32]!==void 0?d[31].set(d[42],d[32]):0,d[43]="product_type",d[33]=d[24].get(d[43]),d[33]!==void 0?d[31].set(d[43],d[33]):0,d[44]="post_id",d[34]=d[24].get(d[44]),d[34]!==void 0?d[31].set(d[44],d[34]):0,d[45]="ad_id",d[35]=d[24].get(d[45]),d[35]!==void 0?d[31].set(d[45],d[35]):0,d[46]="page_id",d[36]=d[24].get(d[46]),d[36]!==void 0?d[31].set(d[46],d[36]):0,d[47]="photo_id",d[37]=d[24].get(d[47]),d[37]!==void 0?d[31].set(d[47],d[37]):0,d[48]="photo_index",d[38]=d[24].get(d[48]),c.i64.neq(d[38],void 0)?d[31].set(d[48],d[38]):0,d[49]="fallback_url",d[39]=d[24].get(d[49]),d[39]!==void 0?d[31].set(d[49],d[39]):0,d[50]="product_id",d[40]=d[24].get(d[50]),d[40]!==void 0?d[31].set(d[50],d[40]):0,d[51]="user_id",d[41]=d[24].get(d[51]),d[41]!==void 0?d[31].set(d[51],d[41]):0,d[29]=d[31]):d[29]=void 0,d[29]!==void 0?(d[31]=d[29].get("page_id"),d[30]=d[31]):d[30]=void 0,d[25]=d[30]):d[25]=void 0,d[2]=d[25]}]):c.resolve(d[2]=void 0)},function(e){return a[3]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[3]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[20]=new c.Map(),d[26]="product_type",d[21]=d[19].get(d[26]),d[21]!==void 0?d[20].set(d[26],d[21]):0,d[27]="product_extras",d[22]=d[19].get(d[27]),d[22]?d[23]=!1:d[23]=!0,d[23]?c.resolve():c.sequence([function(a){return d[22]?d[28]=!1:d[28]=!0,d[28]?c.resolve(d[29]=void 0):c.sequence([function(a){return d[30]=d[22].get("__typename"),d[30]==="XMSGStoryReplyExtras"?c.resolve((d[32]=new c.Map(),d[35]="logging",d[33]=d[22].get(d[35]),d[33]?d[34]=!1:d[34]=!0,d[34]?0:(d[33]?d[36]=!1:d[36]=!0,d[36]?d[37]=void 0:(d[38]=new c.Map(),d[46]="story_author_fbid",d[39]=d[33].get(d[46]),d[39]!==void 0?d[38].set(d[46],d[39]):0,d[47]="camera_post_type",d[40]=d[33].get(d[47]),d[40]!==void 0?d[38].set(d[47],d[40]):0,d[48]="story_type",d[41]=d[33].get(d[48]),d[41]!==void 0?d[38].set(d[48],d[41]):0,d[49]="post_source",d[42]=d[33].get(d[49]),d[42]!==void 0?d[38].set(d[49],d[42]):0,d[50]="fb_post_type",d[43]=d[33].get(d[50]),d[43]!==void 0?d[38].set(d[50],d[43]):0,d[51]="conversation_starter_type",d[44]=d[33].get(d[51]),d[44]!==void 0?d[38].set(d[51],d[44]):0,d[52]="story_reply_type",d[45]=d[33].get(d[52]),d[45]!==void 0?d[38].set(d[52],d[45]):0,d[37]=d[38]),d[32].set(d[35],d[37])),d[31]=d[32])):c.sequence([function(a){return d[30]==="XMSGMarketplaceExtras"?c.sequence([function(a){return d[33]=new c.Map(),d[52]="listing_id",d[34]=d[22].get(d[52]),d[34]!==void 0?d[33].set(d[52],d[34]):0,d[53]="initial_clicked_component",d[35]=d[22].get(d[53]),d[35]!==void 0?d[33].set(d[53],d[35]):0,d[54]="initial_tracking",d[36]=d[22].get(d[54]),d[36]!==void 0?d[33].set(d[54],d[36]):0,d[55]="referral_surface",d[37]=d[22].get(d[55]),d[37]!==void 0?d[33].set(d[55],d[37]):0,d[56]="referral_story_type",d[38]=d[22].get(d[56]),d[38]!==void 0?d[33].set(d[56],d[38]):0,d[57]="referral_ui_component",d[39]=d[22].get(d[57]),d[39]!==void 0?d[33].set(d[57],d[39]):0,d[58]="surface",d[40]=d[22].get(d[58]),d[40]!==void 0?d[33].set(d[58],d[40]):0,d[59]="tracking",d[41]=d[22].get(d[59]),d[41]!==void 0?d[33].set(d[59],d[41]):0,d[60]="ui_component",d[42]=d[22].get(d[60]),d[42]!==void 0?d[33].set(d[60],d[42]):0,d[61]="ad_id",d[43]=d[22].get(d[61]),d[43]!==void 0?d[33].set(d[61],d[43]):0,d[62]="server_session_id",d[44]=d[22].get(d[62]),d[44]!==void 0?d[33].set(d[62],d[44]):0,d[63]="cf_page_id",d[45]=d[22].get(d[63]),d[45]!==void 0?d[33].set(d[63],d[45]):0,d[64]="live_shopping_video_id",d[46]=d[22].get(d[64]),d[46]!==void 0?d[33].set(d[64],d[46]):0,d[65]="logging_id",d[47]=d[22].get(d[65]),c.i64.neq(d[47],void 0)?d[33].set(d[65],d[47]):0,d[66]="photo_ids",d[48]=d[22].get(d[66]),d[48]?d[49]=!1:d[49]=!0,d[49]?c.resolve():c.sequence([function(a){return d[69]=c.createArray(),d[70]=c.i64.of_int32(d[48].length),c.i64.gt(d[70],c.i64.cast([0,0]))?c.loopAsync(d[70],function(a){return d[71]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[48],d[71]).then(function(a){return a=a,d[72]=a[0],d[73]=a[1],a})},function(a){return d[74]=(d[69].push(d[72]),d[69])}])}):c.resolve()},function(a){return d[33].set(d[66],d[69])}])},function(a){return d[67]="is_customized_message",d[50]=d[22].get(d[67]),d[50]!==void 0?d[33].set(d[67],d[50]):0,d[68]="referral_code",d[51]=d[22].get(d[68]),d[51]!==void 0?d[33].set(d[68],d[51]):0,d[32]=d[33]}]):c.sequence([function(a){return d[30]==="XMSGClickToMessengerAdExtras"?c.resolve((d[34]=new c.Map(),d[45]="encrypted_ads_token",d[35]=d[22].get(d[45]),d[35]!==void 0?d[34].set(d[45],d[35]):0,d[46]="product_type",d[36]=d[22].get(d[46]),d[36]!==void 0?d[34].set(d[46],d[36]):0,d[47]="post_id",d[37]=d[22].get(d[47]),d[37]!==void 0?d[34].set(d[47],d[37]):0,d[48]="ad_id",d[38]=d[22].get(d[48]),d[38]!==void 0?d[34].set(d[48],d[38]):0,d[49]="page_id",d[39]=d[22].get(d[49]),d[39]!==void 0?d[34].set(d[49],d[39]):0,d[50]="photo_id",d[40]=d[22].get(d[50]),d[40]!==void 0?d[34].set(d[50],d[40]):0,d[51]="photo_index",d[41]=d[22].get(d[51]),c.i64.neq(d[41],void 0)?d[34].set(d[51],d[41]):0,d[52]="fallback_url",d[42]=d[22].get(d[52]),d[42]!==void 0?d[34].set(d[52],d[42]):0,d[53]="product_id",d[43]=d[22].get(d[53]),d[43]!==void 0?d[34].set(d[53],d[43]):0,d[54]="user_id",d[44]=d[22].get(d[54]),d[44]!==void 0?d[34].set(d[54],d[44]):0,d[33]=d[34])):c.sequence([function(a){return d[30]==="XMSGZorroMessageExtras"?c.resolve((d[35]=new c.Map(),d[37]="is_enabled",d[36]=d[22].get(d[37]),d[36]!==void 0?d[35].set(d[37],d[36]):0,d[34]=d[35])):c.sequence([function(a){return d[30]==="XMSGGenAISuggestedPromptExtras"?c.resolve((d[36]=new c.Map(),d[39]="prompt_type",d[37]=d[22].get(d[39]),d[37]!==void 0?d[36].set(d[39],d[37]):0,d[40]="qpl_join_id",d[38]=d[22].get(d[40]),d[38]!==void 0?d[36].set(d[40],d[38]):0,d[35]=d[36])):c.sequence([function(a){return d[30]==="XMSGGenAIMultiModalExtras"?c.resolve((d[37]=new c.Map(),d[41]="should_skip_genai_eval",d[38]=d[22].get(d[41]),d[38]!==void 0?d[37].set(d[41],d[38]):0,d[42]="associated_multimodal_message_id",d[39]=d[22].get(d[42]),d[39]!==void 0?d[37].set(d[42],d[39]):0,d[43]="qpl_join_id",d[40]=d[22].get(d[43]),d[40]!==void 0?d[37].set(d[43],d[40]):0,d[36]=d[37])):c.sequence([function(a){return d[30]==="XMSGGenAIFlashImagineExtras"?c.resolve((d[38]=new c.Map(),d[41]="seed",d[39]=d[22].get(d[41]),c.i64.neq(d[39],void 0)?d[38].set(d[41],d[39]):0,d[42]="qpl_join_id",d[40]=d[22].get(d[42]),d[40]!==void 0?d[38].set(d[42],d[40]):0,d[37]=d[38])):c.sequence([function(a){return d[30]==="XMSGShareSheetExtras"?c.resolve((d[39]=new c.Map(),d[41]="recipient_selection_session_id",d[40]=d[22].get(d[41]),d[40]!==void 0?d[39].set(d[41],d[40]):0,d[38]=d[39])):c.sequence([function(a){return d[30]==="XMSGGenAIAssistantAPIExtras"?c.sequence([function(a){return d[40]=new c.Map(),d[76]="referrer_session_id",d[41]=d[22].get(d[76]),d[41]!==void 0?d[40].set(d[76],d[41]):0,d[77]="thread_session_id",d[42]=d[22].get(d[77]),d[42]!==void 0?d[40].set(d[77],d[42]):0,d[78]="prompt_id",d[43]=d[22].get(d[78]),d[43]!==void 0?d[40].set(d[78],d[43]):0,d[79]="prompt_type",d[44]=d[22].get(d[79]),d[44]!==void 0?d[40].set(d[79],d[44]):0,d[80]="prompt_fit_topic",d[45]=d[22].get(d[80]),d[45]!==void 0?d[40].set(d[80],d[45]):0,d[81]="location_extras",d[46]=d[22].get(d[81]),d[46]?d[47]=!1:d[47]=!0,d[47]?0:(d[46]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[108]="has_previous_perm_prompt",d[105]=d[46].get(d[108]),d[105]!==void 0?d[104].set(d[108],d[105]):0,d[109]="latitude",d[106]=d[46].get(d[109]),d[106]!==void 0?d[104].set(d[109],d[106]):0,d[110]="longitude",d[107]=d[46].get(d[110]),d[107]!==void 0?d[104].set(d[110],d[107]):0,d[103]=d[104]),d[40].set(d[81],d[103])),d[82]="qpl_join_id",d[48]=d[22].get(d[82]),d[48]!==void 0?d[40].set(d[82],d[48]):0,d[83]="meta_ai_prompt_type",d[49]=d[22].get(d[83]),d[49]!==void 0?d[40].set(d[83],d[49]):0,d[84]="is_subsequent_send",d[50]=d[22].get(d[84]),d[50]!==void 0?d[40].set(d[84],d[50]):0,d[85]="context_injection_type",d[51]=d[22].get(d[85]),d[51]!==void 0?d[40].set(d[85],d[51]):0,d[86]="context_injection_timestamp_ms",d[52]=d[22].get(d[86]),d[52]!==void 0?d[40].set(d[86],d[52]):0,d[87]="meta_ai_response_to_persist",d[53]=d[22].get(d[87]),d[53]?d[54]=!1:d[54]=!0,d[54]?c.resolve():c.sequence([function(a){return d[53]?d[102]=!1:d[102]=!0,d[102]?c.resolve(d[103]=void 0):c.sequence([function(a){return d[104]=new c.Map(),d[111]="text",d[105]=d[53].get(d[111]),d[105]!==void 0?d[104].set(d[111],d[105]):0,d[112]="bot_response_id",d[106]=d[53].get(d[112]),d[106]!==void 0?d[104].set(d[112],d[106]):0,d[113]="bot_request_id",d[107]=d[53].get(d[113]),d[107]!==void 0?d[104].set(d[113],d[107]):0,d[114]="external_search_params",d[108]=d[53].get(d[114]),d[108]?d[109]=!1:d[109]=!0,d[109]?c.resolve():c.sequence([function(a){return d[108]?d[116]=!1:d[116]=!0,d[116]?c.resolve(d[117]=void 0):c.sequence([function(a){return d[118]=new c.Map(),d[126]="search_result_uri",d[119]=d[108].get(d[126]),d[119]?d[120]=!1:d[120]=!0,d[120]?c.resolve():c.sequence([function(a){return d[119]?d[131]=!1:d[131]=!0,d[131]?c.resolve(d[132]=void 0):c.sequence([function(a){return d[133]=c.createArray(),d[134]=c.i64.of_int32(d[119].length),c.i64.gt(d[134],c.i64.cast([0,0]))?c.loopAsync(d[134],function(a){return d[135]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[119],d[135]).then(function(a){return a=a,d[136]=a[0],d[137]=a[1],a})},function(a){return d[138]=(d[133].push(d[136]),d[133])}])}):c.resolve()},function(a){return d[132]=d[133]}])},function(a){return d[118].set(d[126],d[132])}])},function(a){return d[127]="search_query",d[121]=d[108].get(d[127]),d[121]!==void 0?d[118].set(d[127],d[121]):0,d[128]="attribution_link",d[122]=d[108].get(d[128]),d[122]!==void 0?d[118].set(d[128],d[122]):0,d[129]="search_engine",d[123]=d[108].get(d[129]),d[123]!==void 0?d[118].set(d[129],d[123]):0,d[130]="references_title",d[124]=d[108].get(d[130]),d[124]?d[125]=!1:d[125]=!0,d[125]?c.resolve():c.sequence([function(a){return d[124]?d[131]=!1:d[131]=!0,d[131]?c.resolve(d[132]=void 0):c.sequence([function(a){return d[133]=c.createArray(),d[134]=c.i64.of_int32(d[124].length),c.i64.gt(d[134],c.i64.cast([0,0]))?c.loopAsync(d[134],function(a){return d[135]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[124],d[135]).then(function(a){return a=a,d[136]=a[0],d[137]=a[1],a})},function(a){return d[138]=(d[133].push(d[136]),d[133])}])}):c.resolve()},function(a){return d[132]=d[133]}])},function(a){return d[118].set(d[130],d[132])}])},function(a){return d[117]=d[118]}])},function(a){return d[104].set(d[114],d[117])}])},function(a){return d[115]="followup_prompt_text",d[110]=d[53].get(d[115]),d[110]!==void 0?d[104].set(d[115],d[110]):0,d[103]=d[104]}])},function(a){return d[40].set(d[87],d[103])}])},function(a){return d[88]="gql_dark_test_qpl_join_id",d[55]=d[22].get(d[88]),d[55]!==void 0?d[40].set(d[88],d[55]):0,d[89]="gql_dark_test_client_start_time",d[56]=d[22].get(d[89]),d[56]!==void 0?d[40].set(d[89],d[56]):0,d[90]="prompt_context",d[57]=d[22].get(d[90]),d[57]?d[58]=!1:d[58]=!0,d[58]?0:(d[57]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[107]="context_token",d[105]=d[57].get(d[107]),d[105]!==void 0?d[104].set(d[107],d[105]):0,d[108]="context_token_type",d[106]=d[57].get(d[108]),c.i64.neq(d[106],void 0)?d[104].set(d[108],d[106]):0,d[103]=d[104]),d[40].set(d[90],d[103])),d[91]="imagine_flash_extras",d[59]=d[22].get(d[91]),d[59]?d[60]=!1:d[60]=!0,d[60]?0:(d[59]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[107]="seed",d[105]=d[59].get(d[107]),c.i64.neq(d[105],void 0)?d[104].set(d[107],d[105]):0,d[108]="qpl_join_id",d[106]=d[59].get(d[108]),d[106]!==void 0?d[104].set(d[108],d[106]):0,d[103]=d[104]),d[40].set(d[91],d[103])),d[92]="conversation_marker_id",d[61]=d[22].get(d[92]),d[61]!==void 0?d[40].set(d[92],d[61]):0,d[93]="multi_modal_extras",d[62]=d[22].get(d[93]),d[62]?d[63]=!1:d[63]=!0,d[63]?0:(d[62]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[108]="should_skip_genai_eval",d[105]=d[62].get(d[108]),d[105]!==void 0?d[104].set(d[108],d[105]):0,d[109]="associated_multimodal_message_id",d[106]=d[62].get(d[109]),d[106]!==void 0?d[104].set(d[109],d[106]):0,d[110]="qpl_join_id",d[107]=d[62].get(d[110]),d[107]!==void 0?d[104].set(d[110],d[107]):0,d[103]=d[104]),d[40].set(d[93],d[103])),d[94]="ads_extras",d[64]=d[22].get(d[94]),d[64]?d[65]=!1:d[65]=!0,d[65]?0:(d[64]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[108]="context",d[105]=d[64].get(d[108]),d[105]!==void 0?d[104].set(d[108],d[105]):0,d[109]="is_reply_to_ads_ai",d[106]=d[64].get(d[109]),d[106]!==void 0?d[104].set(d[109],d[106]):0,d[110]="is_message_processed_by_lightspeed",d[107]=d[64].get(d[110]),d[107]!==void 0?d[104].set(d[110],d[107]):0,d[103]=d[104]),d[40].set(d[94],d[103])),d[95]="suggested_prompt_extras",d[66]=d[22].get(d[95]),d[66]?d[67]=!1:d[67]=!0,d[67]?0:(d[66]?d[102]=!1:d[102]=!0,d[102]?d[103]=void 0:(d[104]=new c.Map(),d[107]="prompt_type",d[105]=d[66].get(d[107]),d[105]!==void 0?d[104].set(d[107],d[105]):0,d[108]="qpl_join_id",d[106]=d[66].get(d[108]),d[106]!==void 0?d[104].set(d[108],d[106]):0,d[103]=d[104]),d[40].set(d[95],d[103])),d[96]="disable_server_mqtt_typing_indicator",d[68]=d[22].get(d[96]),d[68]!==void 0?d[40].set(d[96],d[68]):0,d[97]="enable_web_scraping",d[69]=d[22].get(d[97]),d[69]!==void 0?d[40].set(d[97],d[69]):0,d[98]="client_prompt_timestamp",d[70]=d[22].get(d[98]),d[70]!==void 0?(d[70]!==void 0?d[102]=c.i64.from_string(d[70]):d[102]=void 0,d[40].set(d[98],d[102])):0,d[99]="is_client_ready_for_psi",d[71]=d[22].get(d[99]),d[71]!==void 0?d[40].set(d[99],d[71]):0,d[100]="intent_detection_extras",d[72]=d[22].get(d[100]),d[72]?d[73]=!1:d[73]=!0,d[73]?c.resolve():c.sequence([function(a){return d[72]?d[102]=!1:d[102]=!0,d[102]?c.resolve(d[103]=void 0):c.sequence([function(a){return d[104]=new c.Map(),d[113]="intent_messages_metadata",d[105]=d[72].get(d[113]),d[105]?d[106]=!1:d[106]=!0,d[106]?c.resolve():c.sequence([function(a){return d[105]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[105].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[105],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=new c.Map(),d[132]="message_type",d[125]=d[122].get(d[132]),d[125]!==void 0?d[124].set(d[132],d[125]):0,d[133]="message_sender_name",d[126]=d[122].get(d[133]),d[126]!==void 0?d[124].set(d[133],d[126]):0,d[134]="message_invoker_name",d[127]=d[122].get(d[134]),d[127]!==void 0?d[124].set(d[134],d[127]):0,d[135]="message_timestamp_ms",d[128]=d[122].get(d[135]),d[128]!==void 0?d[124].set(d[135],c.i64.from_string(d[128])):0,d[136]="message_thread_name",d[129]=d[122].get(d[136]),d[129]!==void 0?d[124].set(d[136],d[129]):0,d[137]="message_id",d[130]=d[122].get(d[137]),d[130]!==void 0?d[124].set(d[137],d[130]):0,d[138]="message_text",d[131]=d[122].get(d[138]),d[131]!==void 0?d[124].set(d[138],d[131]):0,d[139]=(d[119].push(d[124]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[113],d[118])}])},function(a){return d[114]="intent_types",d[107]=d[72].get(d[114]),d[107]?d[108]=!1:d[108]=!0,d[108]?c.resolve():c.sequence([function(a){return d[107]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[107].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[107],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=(d[119].push(d[122]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[114],d[118])}])},function(a){return d[115]="intent_message_ids",d[109]=d[72].get(d[115]),d[109]?d[110]=!1:d[110]=!0,d[110]?c.resolve():c.sequence([function(a){return d[109]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[109].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[109],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=(d[119].push(d[122]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[115],d[118])}])},function(a){return d[116]="intent_messages",d[111]=d[72].get(d[116]),d[111]?d[112]=!1:d[112]=!0,d[112]?c.resolve():c.sequence([function(a){return d[111]?d[117]=!1:d[117]=!0,d[117]?c.resolve(d[118]=void 0):c.sequence([function(a){return d[119]=c.createArray(),d[120]=c.i64.of_int32(d[111].length),c.i64.gt(d[120],c.i64.cast([0,0]))?c.loopAsync(d[120],function(a){return d[121]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[111],d[121]).then(function(a){return a=a,d[122]=a[0],d[123]=a[1],a})},function(a){return d[124]=(d[119].push(d[122]),d[119])}])}):c.resolve()},function(a){return d[118]=d[119]}])},function(a){return d[104].set(d[116],d[118])}])},function(a){return d[103]=d[104]}])},function(a){return d[40].set(d[100],d[103])}])},function(a){return d[101]="psi_tool_query_data",d[74]=d[22].get(d[101]),d[74]?d[75]=!1:d[75]=!0,d[75]?c.resolve():c.sequence([function(a){return d[74]?d[102]=!1:d[102]=!0,d[102]?c.resolve(d[103]=void 0):c.sequence([function(a){return d[104]=new c.Map(),d[110]="conversation_name",d[105]=d[74].get(d[110]),d[105]!==void 0?d[104].set(d[110],d[105]):0,d[111]="original_query_string",d[106]=d[74].get(d[111]),d[106]!==void 0?d[104].set(d[111],d[106]):0,d[112]="response_message_id",d[107]=d[74].get(d[112]),d[107]!==void 0?d[104].set(d[112],d[107]):0,d[113]="messages",d[108]=d[74].get(d[113]),d[108]?d[109]=!1:d[109]=!0,d[109]?c.resolve():c.sequence([function(a){return d[108]?d[114]=!1:d[114]=!0,d[114]?c.resolve(d[115]=void 0):c.sequence([function(a){return d[116]=c.createArray(),d[117]=c.i64.of_int32(d[108].length),c.i64.gt(d[117],c.i64.cast([0,0]))?c.loopAsync(d[117],function(a){return d[118]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[108],d[118]).then(function(a){return a=a,d[119]=a[0],d[120]=a[1],a})},function(a){return d[121]=new c.Map(),d[129]="message_type",d[122]=d[119].get(d[129]),d[122]!==void 0?d[121].set(d[129],d[122]):0,d[130]="message_sender_name",d[123]=d[119].get(d[130]),d[123]!==void 0?d[121].set(d[130],d[123]):0,d[131]="message_invoker_name",d[124]=d[119].get(d[131]),d[124]!==void 0?d[121].set(d[131],d[124]):0,d[132]="message_timestamp_ms",d[125]=d[119].get(d[132]),d[125]!==void 0?d[121].set(d[132],c.i64.from_string(d[125])):0,d[133]="message_thread_name",d[126]=d[119].get(d[133]),d[126]!==void 0?d[121].set(d[133],d[126]):0,d[134]="message_id",d[127]=d[119].get(d[134]),d[127]!==void 0?d[121].set(d[134],d[127]):0,d[135]="message_text",d[128]=d[119].get(d[135]),d[128]!==void 0?d[121].set(d[135],d[128]):0,d[136]=(d[116].push(d[121]),d[116])}])}):c.resolve()},function(a){return d[115]=d[116]}])},function(a){return d[104].set(d[113],d[115])}])},function(a){return d[103]=d[104]}])},function(a){return d[40].set(d[101],d[103])}])},function(a){return d[39]=d[40]}]):c.sequence([function(a){return d[30]==="XMSGProductHighlightExtras"?c.resolve((d[41]=new c.Map(),d[44]="product_highlight_type",d[42]=d[22].get(d[44]),d[42]!==void 0?d[41].set(d[44],d[42]):0,d[45]="conversation_marker",d[43]=d[22].get(d[45]),d[43]!==void 0?d[41].set(d[45],d[43]):0,d[40]=d[41])):c.sequence([function(a){return d[30]==="XMSGMagicMessengerExtras"?c.resolve((d[42]=new c.Map(),d[44]="is_magic_thread",d[43]=d[22].get(d[44]),d[43]!==void 0?d[42].set(d[44],d[43]):0,d[41]=d[42])):c.sequence([function(a){return d[30]==="XMSGAdsAIExtras"?c.resolve((d[43]=new c.Map(),d[47]="context",d[44]=d[22].get(d[47]),d[44]!==void 0?d[43].set(d[47],d[44]):0,d[48]="is_reply_to_ads_ai",d[45]=d[22].get(d[48]),d[45]!==void 0?d[43].set(d[48],d[45]):0,d[49]="is_message_processed_by_lightspeed",d[46]=d[22].get(d[49]),d[46]!==void 0?d[43].set(d[49],d[46]):0,d[42]=d[43])):c.sequence([function(a){return d[30]==="XMSGBizappExtras"?c.resolve((d[44]=new c.Map(),d[47]="message_source",d[45]=d[22].get(d[47]),d[45]!==void 0?d[44].set(d[47],d[45]):0,d[48]="message_trigger",d[46]=d[22].get(d[48]),d[46]!==void 0?d[44].set(d[48],d[46]):0,d[43]=d[44])):c.sequence([function(a){return d[44]=new c.Map(),d[45]=d[22].keys(),d[46]=c.i64.of_int32(d[45].length),c.i64.gt(d[46],c.i64.cast([0,0]))?c.loopAsync(d[46],function(a){return d[47]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[45],d[47]).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],a})},function(a){return d[50]=d[22].get(d[48]),d[44].set(d[48],d[50])}])}):c.resolve()},function(a){return d[43]=d[44]}])},function(a){return d[42]=d[43]}])},function(a){return d[41]=d[42]}])},function(a){return d[40]=d[41]}])},function(a){return d[39]=d[40]}])},function(a){return d[38]=d[39]}])},function(a){return d[37]=d[38]}])},function(a){return d[36]=d[37]}])},function(a){return d[35]=d[36]}])},function(a){return d[34]=d[35]}])},function(a){return d[33]=d[34]}])},function(a){return d[32]=d[33]}])},function(a){return d[31]=d[32]}])},function(a){return d[31].set("__typename",d[30]),d[29]=d[31]}])},function(a){return d[20].set(d[27],d[29])}])},function(a){return d[24]=d[20].get("product_extras"),d[24]!==void 0?(d[28]=d[24].get("__typename"),d[28]==="XMSGClickToMessengerAdExtras"?(d[31]=new c.Map(),d[42]="encrypted_ads_token",d[32]=d[24].get(d[42]),d[32]!==void 0?d[31].set(d[42],d[32]):0,d[43]="product_type",d[33]=d[24].get(d[43]),d[33]!==void 0?d[31].set(d[43],d[33]):0,d[44]="post_id",d[34]=d[24].get(d[44]),d[34]!==void 0?d[31].set(d[44],d[34]):0,d[45]="ad_id",d[35]=d[24].get(d[45]),d[35]!==void 0?d[31].set(d[45],d[35]):0,d[46]="page_id",d[36]=d[24].get(d[46]),d[36]!==void 0?d[31].set(d[46],d[36]):0,d[47]="photo_id",d[37]=d[24].get(d[47]),d[37]!==void 0?d[31].set(d[47],d[37]):0,d[48]="photo_index",d[38]=d[24].get(d[48]),c.i64.neq(d[38],void 0)?d[31].set(d[48],d[38]):0,d[49]="fallback_url",d[39]=d[24].get(d[49]),d[39]!==void 0?d[31].set(d[49],d[39]):0,d[50]="product_id",d[40]=d[24].get(d[50]),d[40]!==void 0?d[31].set(d[50],d[40]):0,d[51]="user_id",d[41]=d[24].get(d[51]),d[41]!==void 0?d[31].set(d[51],d[41]):0,d[29]=d[31]):d[29]=void 0,d[29]!==void 0?(d[31]=d[29].get("product_type"),d[30]=d[31]):d[30]=void 0,d[25]=d[30]):d[25]=void 0,d[3]=d[25]}]):c.resolve(d[3]=void 0)},function(a){return d[3]==="CTM"?(d[2]!==void 0?d[19]=c.i64.from_string(d[2]):d[19]=d[1],d[4]=d[19]):d[4]=d[1],d[5]=c.i64.cast([0,1083495711]),d[6]=c.i64.cast([0,1024]),d[7]=c.i64.cast([0,0]),d[8]=c.i64.cast([0,0]),d[9]=c.i64.cast([0,134217728]),void 0?d[10]=!1:d[10]=!0,d[10]?(a=["",void 0,void 0,void 0,void 0],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4],a):(d[19]=(void 0).get("nullstate_description_text1"),d[19]!==void 0?d[20]=d[19]:d[20]="",d[21]=(void 0).get("nullstate_description_text2"),d[22]=(void 0).get("nullstate_description_text3"),d[23]=(void 0).get("nullstate_description_text4"),d[24]=(void 0).get("nullstate_description_text5"),a=[d[20],d[21],d[22],d[23],d[24]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4]),c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[16]=a[0],a})},function(a){return c.forEach(c.filter(c.db.table(9).fetch([[[d[4]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:d[4],mailboxType:c.i64.cast([0,0]),threadType:c.i64.cast([0,2]),clientThreadKey:d[4],folderName:"inbox",parentThreadKey:c.i64.cast([0,0]),lastActivityTimestampMs:c.i64.cast([0,0]),lastReadWatermarkTimestampMs:c.i64.cast([0,0]),snippetHasEmoji:!1,snippetSenderContactId:d[16],ongoingCallState:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),capabilities:d[5],capabilities2:d[6],capabilities3:d[7],capabilities4:d[8],capabilities5:d[9],nullstateDescriptionText1:d[11],nullstateDescriptionText2:d[12],nullstateDescriptionText3:d[13],threadName:a[2]})},function(a){return d[17]=c.createArray(),c.resolve()},function(b){return a[3]!==void 0?c.db.table(312).add({threadKey:d[4],metadata:a[3]}):c.resolve()},function(e){return d[18]=c.i64.of_int32(a[0].length),c.i64.gt(d[18],c.i64.cast([0,0]))?c.loopAsync(d[18],function(e){return d[19]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[19]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(a){return c.forEach(c.filter(c.db.table(14).fetch([[[d[4],d[20]]]]),function(a){return c.i64.eq(a.threadKey,d[4])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(a.contactId,d[20])&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(14).add({threadKey:d[4],contactId:d[20],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),isModerator:!1})}])}):c.resolve()},function(a){return e[0]=d[4]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticGroupThreadStoredProcedure";a.__tables__=["threads","threads_optimistic_metadata","participants"];e.exports=a}),null);
__d("LSCreateGroupThreadWithAdminText",["LSCreateOfflineThreadingID","LSIssueNewTask","LSLocalApplyOptimisticGroupThread"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticGroupThread"),a[0],a[1],a[2],void 0).then(function(a){return a=a,d[0]=a[0],a})},function(e){return a[2]===void 0&&!1?(d[1]=new c.Map(),d[1].set("participants",a[0]),d[1].set("client_thread_key",d[0]),d[1].set("sync_group",c.i64.cast([0,1])),d[1].set("thread_name",a[2]),d[1].set("text",a[3]),d[1].set("thread_metadata",void 0),d[1].set("should_create_group_if_not_exists",!0),d[1].set("group_thread_creation_entry_point",void 0),d[2]=d[1].get("client_thread_key"),d[3]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[2]),c.i64.cast([0,153]),d[3],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.sequence([function(a){return d[1]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[1]).then(function(a){return a=a,d[2]=a[0],a})},function(a){return c.forEach(c.db.table(9).fetch([[[d[0]]]]),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:c.i64.to_string(d[2])})})},function(e){return d[3]=new c.Map(),d[3].set("thread_id",d[0]),d[3].set("otid",c.i64.to_string(d[2])),d[3].set("source",c.i64.cast([0,0])),d[3].set("send_type",c.i64.cast([0,8])),a[3]!==void 0?d[3].set("text",a[3]):0,d[4]=new c.Map(),d[4].set("participants",a[0]),d[4].set("send_payload",d[3]),a[2]!==void 0?d[4].set("thread_name",a[2]):0,void 0!==void 0?d[4].set("thread_metadata",void 0):0,void 0!==void 0?d[4].set("group_thread_creation_entry_point",void 0):0,void 0===void 0||!1?(d[5]=d[4].get("send_payload"),d[6]=d[5].get("thread_id"),d[7]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[6]),c.i64.cast([0,130]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):(d[5]=d[4].get("send_payload"),d[6]=d[5].get("thread_id"),d[7]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[6]),c.i64.cast([0,787]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,1]),void 0,c.i64.cast([0,0]),c.i64.cast([0,0])))}])},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxCreateGroupThreadWithAdminTextStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSLocalCreateOptimisticGroupThread",["LSArrayGetObjectAt","LSGetViewerFBID","LSIssueNewTask","LSLocalApplyOptimisticGroupThread"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return void 0?d[0]=!1:d[0]=!0,d[0]?(e=["",void 0,void 0,void 0,void 0],d[1]=e[0],d[2]=e[1],d[3]=e[2],d[4]=e[3],d[5]=e[4],e):(d[8]=(void 0).get("nullstate_description_text1"),d[8]!==void 0?d[9]=d[8]:d[9]="",d[10]=(void 0).get("nullstate_description_text2"),d[11]=(void 0).get("nullstate_description_text3"),d[12]=(void 0).get("nullstate_description_text4"),d[13]=(void 0).get("nullstate_description_text5"),e=[d[9],d[10],d[11],d[12],d[13]],d[1]=e[0],d[2]=e[1],d[3]=e[2],d[4]=e[3],d[5]=e[4]),d[6]=new c.Map(),d[6].set("nullstate_description_text1",d[1]),d[6].set("nullstate_description_text2",d[2]),d[6].set("nullstate_description_text3",d[3]),d[6].set("nullstate_description_text4",d[4]),d[6].set("nullstate_description_text5",d[5]),c.storedProcedure(b("LSLocalApplyOptimisticGroupThread"),a[0],void 0,a[2],a[4]).then(function(a){return a=a,d[7]=a[0],a})},function(e){return a[3]===!0?c.i64.eq(c.i64.cast([0,2]),c.i64.cast([0,5]))?a[4]!==void 0?c.sequence([function(a){return c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[8]=a[0],a})},function(e){return d[9]=c.i64.cast([0,0]),d[10]=c.i64.of_int32(a[0].length),c.i64.gt(d[10],c.i64.cast([0,0]))?c.loopAsync(d[10],function(e){return d[11]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[11]).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(a){return c.i64.neq(d[12],d[8])?d[14]=d[12]:d[14]=d[9],d[9]=d[14]}])}):c.resolve()},function(e){return a[4]!==void 0?(d[11]=new c.Map(),d[11].set("seller_id",d[9]),d[11].set("thread_metadata",a[4]),d[11].set("client_thread_key",d[7]),d[12]=d[11].get("client_thread_key"),d[13]=c.toJSON(d[11]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[12]),c.i64.cast([0,646]),d[13],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.resolve()}]):c.resolve(function(a){c.logger(a).mustfix(a)}("Marketplace thread metadata cannot be null")):(d[8]=new c.Map(),d[8].set("participants",a[0]),d[8].set("client_thread_key",d[7]),d[8].set("sync_group",c.i64.cast([0,1])),d[9]=d[8].get("client_thread_key"),d[10]=c.toJSON(d[8]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[9]),c.i64.cast([0,153]),d[10],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.resolve()},function(a){return e[0]=d[7]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalCreateOptimisticGroupThreadStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSMediaUrlAttachment",["I64","LSMediaUrlUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=a.previewUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?a.previewUrlFallback:a.previewUrl}function b(a){var b=a.previewUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?a.previewUrlFallback:a.previewUrlLarge}function c(a){var b=a.playableUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?a.playableUrlFallback:a.playableUrl}function e(a){var b=a.imageUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?a.imageUrlFallback:a.imageUrl}function f(a){var b=a.faviconUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?a.faviconUrlFallback:a.faviconUrl}function i(a){try{var b=a.listItemContactUrlExpirationTimestampList1;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired((h||(h=d("I64"))).of_string(b))?a.listItemContactUrlFallbackList1:a.listItemContactUrlList1}catch(b){return a.listItemContactUrlList1}}function j(a){try{var b=a.listItemContactUrlExpirationTimestampList2;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired((h||(h=d("I64"))).of_string(b))?a.listItemContactUrlFallbackList2:a.listItemContactUrlList2}catch(b){return a.listItemContactUrlList2}}function k(a){try{var b=a.listItemContactUrlExpirationTimestampList3;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired((h||(h=d("I64"))).of_string(b))?a.listItemContactUrlFallbackList3:a.listItemContactUrlList3}catch(b){return a.listItemContactUrlList3}}function l(a){var b=a.headerImageUrlExpirationTimestampMs;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)?a.headerImageUrlFallback:a.headerImageUrl}function m(a){try{var b=a.listItemProfilePictureUrlExpirationTimestamp1;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired((h||(h=d("I64"))).of_string(b)))return a.listItemProfilePictureUrlFallback1;else return a.listItemProfilePictureUrl1}catch(b){return a.listItemProfilePictureUrl1}}function n(a){try{var b=a.listItemProfilePictureUrlExpirationTimestamp2;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired((h||(h=d("I64"))).of_string(b))?a.listItemProfilePictureUrlFallback2:a.listItemProfilePictureUrl2}catch(b){return a.listItemProfilePictureUrl2}}function o(a){try{var b=a.listItemProfilePictureUrlExpirationTimestamp3;return b!=null&&d("LSMediaUrlUtils").isTimestampExpired((h||(h=d("I64"))).of_string(b))?a.listItemProfilePictureUrlFallback3:a.listItemProfilePictureUrl3}catch(b){return a.listItemProfilePictureUrl3}}g.previewUrl=a;g.previewUrlLarge=b;g.playableUrl=c;g.imageUrl=e;g.faviconUrl=f;g.listItemContactUrlList1=i;g.listItemContactUrlList2=j;g.listItemContactUrlList3=k;g.headerImageUrl=l;g.listItemProfilePictureUrl1=m;g.listItemProfilePictureUrl2=n;g.listItemProfilePictureUrl3=o}),98);
__d("LSMessagePointQuery",["LSIssueNewTask","LSVerifyThreadRowExists"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.filter(c.db.table(12).fetch([[[a[1]]],"messageId"]),function(b){return c.i64.eq(b.threadKey,a[0])&&b.messageId===a[1]}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(d){return c.storedProcedure(b("LSVerifyThreadRowExists"),a[0],a[2],c.i64.cast([0,1]))},function(b){return c.db.table(13).add({threadKey:a[0],minTimestampMs:c.i64.cast([0,0]),minMessageId:a[1],maxTimestampMs:c.i64.cast([0,0]),maxMessageId:a[1],isLoadingBefore:!0,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[1]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[1]=d[6])})},function(e){return d[3]=new c.Map(),d[3].set("thread_key",a[0]),d[3].set("message_id",a[1]),d[3].set("sync_group",d[1]),d[3].set("num_context_messages",a[3]),d[4]=d[3].get("thread_key"),d[5]=c.toJSON(d[3]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[4]),c.i64.cast([0,19]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,d[1]=f.timestampMs,c.filter(c.db.table(13).fetch([[[a[0],{lte:d[1]}]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.le(b.minTimestampMs,d[1])&&c.i64.ge(b.maxTimestampMs,d[1])}).next().then(function(f){var e=f.done;f.value;return e?c.sequence([function(b){return c.db.table(13).add({threadKey:a[0],minTimestampMs:c.i64.cast([0,0]),minMessageId:a[1],maxTimestampMs:c.i64.cast([0,0]),maxMessageId:a[1],isLoadingBefore:!0,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[8]=e.syncGroup,c.i64.neq(d[8],void 0)?d[7]=d[8]:d[7]=c.i64.cast([0,1]),d[2]=d[7])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("message_id",a[1]),d[4].set("sync_group",d[2]),d[4].set("num_context_messages",a[3]),d[5]=d[4].get("thread_key"),d[6]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[5]),c.i64.cast([0,19]),d[6],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):0}))})},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxMessagePointQueryStoredProcedure";a.__tables__=["messages","messages_ranges_v2__generated","threads"];e.exports=a}),null);
__d("LSVerifyThreadRowExistsV2",["LSVerifyThreadExistsV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.i64.eq(a[1],c.i64.cast([0,5]))?d[0]=c.i64.cast([-1,4294967284]):d[0]=c.i64.cast([0,0]),c.storedProcedure(b("LSVerifyThreadExistsV2"),a[0],a[1],"inbox",d[0],a[3],!1,a[2],!1,!1)},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxVerifyThreadRowExistsV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSVerifyThreadView",["LSArrayGetObjectAt","LSComputeOptimisticThreadCapabilities","LSCreateGroupThreadWithAdminText","LSCreateOfflineThreadingID","LSDeserializeFromJsonIntoDictionaryV2.nop","LSInsertNewMessageRange","LSIssueNewTask","LSLocalCreateOptimisticGroupThread","LSMessagePointQuery","LSVerifyContactRowExists","LSVerifyThreadRowExists","LSVerifyThreadRowExistsV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return a[8]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[8]).then(function(a){return a=a,d[3]=a[0],a})},function(a){return d[4]=new c.Map(),d[9]="product_type",d[5]=d[3].get(d[9]),d[5]!==void 0?d[4].set(d[9],d[5]):0,d[10]="product_extras",d[6]=d[3].get(d[10]),d[6]?d[7]=!1:d[7]=!0,d[7]?c.resolve():c.sequence([function(a){return d[6]?d[11]=!1:d[11]=!0,d[11]?c.resolve(d[12]=void 0):c.sequence([function(a){return d[13]=d[6].get("__typename"),d[13]==="XMSGStoryReplyExtras"?c.resolve((d[15]=new c.Map(),d[18]="logging",d[16]=d[6].get(d[18]),d[16]?d[17]=!1:d[17]=!0,d[17]?0:(d[16]?d[19]=!1:d[19]=!0,d[19]?d[20]=void 0:(d[21]=new c.Map(),d[29]="story_author_fbid",d[22]=d[16].get(d[29]),d[22]!==void 0?d[21].set(d[29],d[22]):0,d[30]="camera_post_type",d[23]=d[16].get(d[30]),d[23]!==void 0?d[21].set(d[30],d[23]):0,d[31]="story_type",d[24]=d[16].get(d[31]),d[24]!==void 0?d[21].set(d[31],d[24]):0,d[32]="post_source",d[25]=d[16].get(d[32]),d[25]!==void 0?d[21].set(d[32],d[25]):0,d[33]="fb_post_type",d[26]=d[16].get(d[33]),d[26]!==void 0?d[21].set(d[33],d[26]):0,d[34]="conversation_starter_type",d[27]=d[16].get(d[34]),d[27]!==void 0?d[21].set(d[34],d[27]):0,d[35]="story_reply_type",d[28]=d[16].get(d[35]),d[28]!==void 0?d[21].set(d[35],d[28]):0,d[20]=d[21]),d[15].set(d[18],d[20])),d[14]=d[15])):c.sequence([function(a){return d[13]==="XMSGMarketplaceExtras"?c.sequence([function(a){return d[16]=new c.Map(),d[35]="listing_id",d[17]=d[6].get(d[35]),d[17]!==void 0?d[16].set(d[35],d[17]):0,d[36]="initial_clicked_component",d[18]=d[6].get(d[36]),d[18]!==void 0?d[16].set(d[36],d[18]):0,d[37]="initial_tracking",d[19]=d[6].get(d[37]),d[19]!==void 0?d[16].set(d[37],d[19]):0,d[38]="referral_surface",d[20]=d[6].get(d[38]),d[20]!==void 0?d[16].set(d[38],d[20]):0,d[39]="referral_story_type",d[21]=d[6].get(d[39]),d[21]!==void 0?d[16].set(d[39],d[21]):0,d[40]="referral_ui_component",d[22]=d[6].get(d[40]),d[22]!==void 0?d[16].set(d[40],d[22]):0,d[41]="surface",d[23]=d[6].get(d[41]),d[23]!==void 0?d[16].set(d[41],d[23]):0,d[42]="tracking",d[24]=d[6].get(d[42]),d[24]!==void 0?d[16].set(d[42],d[24]):0,d[43]="ui_component",d[25]=d[6].get(d[43]),d[25]!==void 0?d[16].set(d[43],d[25]):0,d[44]="ad_id",d[26]=d[6].get(d[44]),d[26]!==void 0?d[16].set(d[44],d[26]):0,d[45]="server_session_id",d[27]=d[6].get(d[45]),d[27]!==void 0?d[16].set(d[45],d[27]):0,d[46]="cf_page_id",d[28]=d[6].get(d[46]),d[28]!==void 0?d[16].set(d[46],d[28]):0,d[47]="live_shopping_video_id",d[29]=d[6].get(d[47]),d[29]!==void 0?d[16].set(d[47],d[29]):0,d[48]="logging_id",d[30]=d[6].get(d[48]),c.i64.neq(d[30],void 0)?d[16].set(d[48],d[30]):0,d[49]="photo_ids",d[31]=d[6].get(d[49]),d[31]?d[32]=!1:d[32]=!0,d[32]?c.resolve():c.sequence([function(a){return d[52]=c.createArray(),d[53]=c.i64.of_int32(d[31].length),c.i64.gt(d[53],c.i64.cast([0,0]))?c.loopAsync(d[53],function(a){return d[54]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[31],d[54]).then(function(a){return a=a,d[55]=a[0],d[56]=a[1],a})},function(a){return d[57]=(d[52].push(d[55]),d[52])}])}):c.resolve()},function(a){return d[16].set(d[49],d[52])}])},function(a){return d[50]="is_customized_message",d[33]=d[6].get(d[50]),d[33]!==void 0?d[16].set(d[50],d[33]):0,d[51]="referral_code",d[34]=d[6].get(d[51]),d[34]!==void 0?d[16].set(d[51],d[34]):0,d[15]=d[16]}]):c.sequence([function(a){return d[13]==="XMSGClickToMessengerAdExtras"?c.resolve((d[17]=new c.Map(),d[28]="encrypted_ads_token",d[18]=d[6].get(d[28]),d[18]!==void 0?d[17].set(d[28],d[18]):0,d[29]="product_type",d[19]=d[6].get(d[29]),d[19]!==void 0?d[17].set(d[29],d[19]):0,d[30]="post_id",d[20]=d[6].get(d[30]),d[20]!==void 0?d[17].set(d[30],d[20]):0,d[31]="ad_id",d[21]=d[6].get(d[31]),d[21]!==void 0?d[17].set(d[31],d[21]):0,d[32]="page_id",d[22]=d[6].get(d[32]),d[22]!==void 0?d[17].set(d[32],d[22]):0,d[33]="photo_id",d[23]=d[6].get(d[33]),d[23]!==void 0?d[17].set(d[33],d[23]):0,d[34]="photo_index",d[24]=d[6].get(d[34]),c.i64.neq(d[24],void 0)?d[17].set(d[34],d[24]):0,d[35]="fallback_url",d[25]=d[6].get(d[35]),d[25]!==void 0?d[17].set(d[35],d[25]):0,d[36]="product_id",d[26]=d[6].get(d[36]),d[26]!==void 0?d[17].set(d[36],d[26]):0,d[37]="user_id",d[27]=d[6].get(d[37]),d[27]!==void 0?d[17].set(d[37],d[27]):0,d[16]=d[17])):c.sequence([function(a){return d[13]==="XMSGZorroMessageExtras"?c.resolve((d[18]=new c.Map(),d[20]="is_enabled",d[19]=d[6].get(d[20]),d[19]!==void 0?d[18].set(d[20],d[19]):0,d[17]=d[18])):c.sequence([function(a){return d[13]==="XMSGGenAISuggestedPromptExtras"?c.resolve((d[19]=new c.Map(),d[22]="prompt_type",d[20]=d[6].get(d[22]),d[20]!==void 0?d[19].set(d[22],d[20]):0,d[23]="qpl_join_id",d[21]=d[6].get(d[23]),d[21]!==void 0?d[19].set(d[23],d[21]):0,d[18]=d[19])):c.sequence([function(a){return d[13]==="XMSGGenAIMultiModalExtras"?c.resolve((d[20]=new c.Map(),d[24]="should_skip_genai_eval",d[21]=d[6].get(d[24]),d[21]!==void 0?d[20].set(d[24],d[21]):0,d[25]="associated_multimodal_message_id",d[22]=d[6].get(d[25]),d[22]!==void 0?d[20].set(d[25],d[22]):0,d[26]="qpl_join_id",d[23]=d[6].get(d[26]),d[23]!==void 0?d[20].set(d[26],d[23]):0,d[19]=d[20])):c.sequence([function(a){return d[13]==="XMSGGenAIFlashImagineExtras"?c.resolve((d[21]=new c.Map(),d[24]="seed",d[22]=d[6].get(d[24]),c.i64.neq(d[22],void 0)?d[21].set(d[24],d[22]):0,d[25]="qpl_join_id",d[23]=d[6].get(d[25]),d[23]!==void 0?d[21].set(d[25],d[23]):0,d[20]=d[21])):c.sequence([function(a){return d[13]==="XMSGShareSheetExtras"?c.resolve((d[22]=new c.Map(),d[24]="recipient_selection_session_id",d[23]=d[6].get(d[24]),d[23]!==void 0?d[22].set(d[24],d[23]):0,d[21]=d[22])):c.sequence([function(a){return d[13]==="XMSGGenAIAssistantAPIExtras"?c.sequence([function(a){return d[23]=new c.Map(),d[59]="referrer_session_id",d[24]=d[6].get(d[59]),d[24]!==void 0?d[23].set(d[59],d[24]):0,d[60]="thread_session_id",d[25]=d[6].get(d[60]),d[25]!==void 0?d[23].set(d[60],d[25]):0,d[61]="prompt_id",d[26]=d[6].get(d[61]),d[26]!==void 0?d[23].set(d[61],d[26]):0,d[62]="prompt_type",d[27]=d[6].get(d[62]),d[27]!==void 0?d[23].set(d[62],d[27]):0,d[63]="prompt_fit_topic",d[28]=d[6].get(d[63]),d[28]!==void 0?d[23].set(d[63],d[28]):0,d[64]="location_extras",d[29]=d[6].get(d[64]),d[29]?d[30]=!1:d[30]=!0,d[30]?0:(d[29]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[87]=new c.Map(),d[91]="has_previous_perm_prompt",d[88]=d[29].get(d[91]),d[88]!==void 0?d[87].set(d[91],d[88]):0,d[92]="latitude",d[89]=d[29].get(d[92]),d[89]!==void 0?d[87].set(d[92],d[89]):0,d[93]="longitude",d[90]=d[29].get(d[93]),d[90]!==void 0?d[87].set(d[93],d[90]):0,d[86]=d[87]),d[23].set(d[64],d[86])),d[65]="qpl_join_id",d[31]=d[6].get(d[65]),d[31]!==void 0?d[23].set(d[65],d[31]):0,d[66]="meta_ai_prompt_type",d[32]=d[6].get(d[66]),d[32]!==void 0?d[23].set(d[66],d[32]):0,d[67]="is_subsequent_send",d[33]=d[6].get(d[67]),d[33]!==void 0?d[23].set(d[67],d[33]):0,d[68]="context_injection_type",d[34]=d[6].get(d[68]),d[34]!==void 0?d[23].set(d[68],d[34]):0,d[69]="context_injection_timestamp_ms",d[35]=d[6].get(d[69]),d[35]!==void 0?d[23].set(d[69],d[35]):0,d[70]="meta_ai_response_to_persist",d[36]=d[6].get(d[70]),d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve():c.sequence([function(a){return d[36]?d[85]=!1:d[85]=!0,d[85]?c.resolve(d[86]=void 0):c.sequence([function(a){return d[87]=new c.Map(),d[94]="text",d[88]=d[36].get(d[94]),d[88]!==void 0?d[87].set(d[94],d[88]):0,d[95]="bot_response_id",d[89]=d[36].get(d[95]),d[89]!==void 0?d[87].set(d[95],d[89]):0,d[96]="bot_request_id",d[90]=d[36].get(d[96]),d[90]!==void 0?d[87].set(d[96],d[90]):0,d[97]="external_search_params",d[91]=d[36].get(d[97]),d[91]?d[92]=!1:d[92]=!0,d[92]?c.resolve():c.sequence([function(a){return d[91]?d[99]=!1:d[99]=!0,d[99]?c.resolve(d[100]=void 0):c.sequence([function(a){return d[101]=new c.Map(),d[109]="search_result_uri",d[102]=d[91].get(d[109]),d[102]?d[103]=!1:d[103]=!0,d[103]?c.resolve():c.sequence([function(a){return d[102]?d[114]=!1:d[114]=!0,d[114]?c.resolve(d[115]=void 0):c.sequence([function(a){return d[116]=c.createArray(),d[117]=c.i64.of_int32(d[102].length),c.i64.gt(d[117],c.i64.cast([0,0]))?c.loopAsync(d[117],function(a){return d[118]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[102],d[118]).then(function(a){return a=a,d[119]=a[0],d[120]=a[1],a})},function(a){return d[121]=(d[116].push(d[119]),d[116])}])}):c.resolve()},function(a){return d[115]=d[116]}])},function(a){return d[101].set(d[109],d[115])}])},function(a){return d[110]="search_query",d[104]=d[91].get(d[110]),d[104]!==void 0?d[101].set(d[110],d[104]):0,d[111]="attribution_link",d[105]=d[91].get(d[111]),d[105]!==void 0?d[101].set(d[111],d[105]):0,d[112]="search_engine",d[106]=d[91].get(d[112]),d[106]!==void 0?d[101].set(d[112],d[106]):0,d[113]="references_title",d[107]=d[91].get(d[113]),d[107]?d[108]=!1:d[108]=!0,d[108]?c.resolve():c.sequence([function(a){return d[107]?d[114]=!1:d[114]=!0,d[114]?c.resolve(d[115]=void 0):c.sequence([function(a){return d[116]=c.createArray(),d[117]=c.i64.of_int32(d[107].length),c.i64.gt(d[117],c.i64.cast([0,0]))?c.loopAsync(d[117],function(a){return d[118]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[107],d[118]).then(function(a){return a=a,d[119]=a[0],d[120]=a[1],a})},function(a){return d[121]=(d[116].push(d[119]),d[116])}])}):c.resolve()},function(a){return d[115]=d[116]}])},function(a){return d[101].set(d[113],d[115])}])},function(a){return d[100]=d[101]}])},function(a){return d[87].set(d[97],d[100])}])},function(a){return d[98]="followup_prompt_text",d[93]=d[36].get(d[98]),d[93]!==void 0?d[87].set(d[98],d[93]):0,d[86]=d[87]}])},function(a){return d[23].set(d[70],d[86])}])},function(a){return d[71]="gql_dark_test_qpl_join_id",d[38]=d[6].get(d[71]),d[38]!==void 0?d[23].set(d[71],d[38]):0,d[72]="gql_dark_test_client_start_time",d[39]=d[6].get(d[72]),d[39]!==void 0?d[23].set(d[72],d[39]):0,d[73]="prompt_context",d[40]=d[6].get(d[73]),d[40]?d[41]=!1:d[41]=!0,d[41]?0:(d[40]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[87]=new c.Map(),d[90]="context_token",d[88]=d[40].get(d[90]),d[88]!==void 0?d[87].set(d[90],d[88]):0,d[91]="context_token_type",d[89]=d[40].get(d[91]),c.i64.neq(d[89],void 0)?d[87].set(d[91],d[89]):0,d[86]=d[87]),d[23].set(d[73],d[86])),d[74]="imagine_flash_extras",d[42]=d[6].get(d[74]),d[42]?d[43]=!1:d[43]=!0,d[43]?0:(d[42]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[87]=new c.Map(),d[90]="seed",d[88]=d[42].get(d[90]),c.i64.neq(d[88],void 0)?d[87].set(d[90],d[88]):0,d[91]="qpl_join_id",d[89]=d[42].get(d[91]),d[89]!==void 0?d[87].set(d[91],d[89]):0,d[86]=d[87]),d[23].set(d[74],d[86])),d[75]="conversation_marker_id",d[44]=d[6].get(d[75]),d[44]!==void 0?d[23].set(d[75],d[44]):0,d[76]="multi_modal_extras",d[45]=d[6].get(d[76]),d[45]?d[46]=!1:d[46]=!0,d[46]?0:(d[45]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[87]=new c.Map(),d[91]="should_skip_genai_eval",d[88]=d[45].get(d[91]),d[88]!==void 0?d[87].set(d[91],d[88]):0,d[92]="associated_multimodal_message_id",d[89]=d[45].get(d[92]),d[89]!==void 0?d[87].set(d[92],d[89]):0,d[93]="qpl_join_id",d[90]=d[45].get(d[93]),d[90]!==void 0?d[87].set(d[93],d[90]):0,d[86]=d[87]),d[23].set(d[76],d[86])),d[77]="ads_extras",d[47]=d[6].get(d[77]),d[47]?d[48]=!1:d[48]=!0,d[48]?0:(d[47]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[87]=new c.Map(),d[91]="context",d[88]=d[47].get(d[91]),d[88]!==void 0?d[87].set(d[91],d[88]):0,d[92]="is_reply_to_ads_ai",d[89]=d[47].get(d[92]),d[89]!==void 0?d[87].set(d[92],d[89]):0,d[93]="is_message_processed_by_lightspeed",d[90]=d[47].get(d[93]),d[90]!==void 0?d[87].set(d[93],d[90]):0,d[86]=d[87]),d[23].set(d[77],d[86])),d[78]="suggested_prompt_extras",d[49]=d[6].get(d[78]),d[49]?d[50]=!1:d[50]=!0,d[50]?0:(d[49]?d[85]=!1:d[85]=!0,d[85]?d[86]=void 0:(d[87]=new c.Map(),d[90]="prompt_type",d[88]=d[49].get(d[90]),d[88]!==void 0?d[87].set(d[90],d[88]):0,d[91]="qpl_join_id",d[89]=d[49].get(d[91]),d[89]!==void 0?d[87].set(d[91],d[89]):0,d[86]=d[87]),d[23].set(d[78],d[86])),d[79]="disable_server_mqtt_typing_indicator",d[51]=d[6].get(d[79]),d[51]!==void 0?d[23].set(d[79],d[51]):0,d[80]="enable_web_scraping",d[52]=d[6].get(d[80]),d[52]!==void 0?d[23].set(d[80],d[52]):0,d[81]="client_prompt_timestamp",d[53]=d[6].get(d[81]),d[53]!==void 0?(d[53]!==void 0?d[85]=c.i64.from_string(d[53]):d[85]=void 0,d[23].set(d[81],d[85])):0,d[82]="is_client_ready_for_psi",d[54]=d[6].get(d[82]),d[54]!==void 0?d[23].set(d[82],d[54]):0,d[83]="intent_detection_extras",d[55]=d[6].get(d[83]),d[55]?d[56]=!1:d[56]=!0,d[56]?c.resolve():c.sequence([function(a){return d[55]?d[85]=!1:d[85]=!0,d[85]?c.resolve(d[86]=void 0):c.sequence([function(a){return d[87]=new c.Map(),d[96]="intent_messages_metadata",d[88]=d[55].get(d[96]),d[88]?d[89]=!1:d[89]=!0,d[89]?c.resolve():c.sequence([function(a){return d[88]?d[100]=!1:d[100]=!0,d[100]?c.resolve(d[101]=void 0):c.sequence([function(a){return d[102]=c.createArray(),d[103]=c.i64.of_int32(d[88].length),c.i64.gt(d[103],c.i64.cast([0,0]))?c.loopAsync(d[103],function(a){return d[104]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[88],d[104]).then(function(a){return a=a,d[105]=a[0],d[106]=a[1],a})},function(a){return d[107]=new c.Map(),d[115]="message_type",d[108]=d[105].get(d[115]),d[108]!==void 0?d[107].set(d[115],d[108]):0,d[116]="message_sender_name",d[109]=d[105].get(d[116]),d[109]!==void 0?d[107].set(d[116],d[109]):0,d[117]="message_invoker_name",d[110]=d[105].get(d[117]),d[110]!==void 0?d[107].set(d[117],d[110]):0,d[118]="message_timestamp_ms",d[111]=d[105].get(d[118]),d[111]!==void 0?d[107].set(d[118],c.i64.from_string(d[111])):0,d[119]="message_thread_name",d[112]=d[105].get(d[119]),d[112]!==void 0?d[107].set(d[119],d[112]):0,d[120]="message_id",d[113]=d[105].get(d[120]),d[113]!==void 0?d[107].set(d[120],d[113]):0,d[121]="message_text",d[114]=d[105].get(d[121]),d[114]!==void 0?d[107].set(d[121],d[114]):0,d[122]=(d[102].push(d[107]),d[102])}])}):c.resolve()},function(a){return d[101]=d[102]}])},function(a){return d[87].set(d[96],d[101])}])},function(a){return d[97]="intent_types",d[90]=d[55].get(d[97]),d[90]?d[91]=!1:d[91]=!0,d[91]?c.resolve():c.sequence([function(a){return d[90]?d[100]=!1:d[100]=!0,d[100]?c.resolve(d[101]=void 0):c.sequence([function(a){return d[102]=c.createArray(),d[103]=c.i64.of_int32(d[90].length),c.i64.gt(d[103],c.i64.cast([0,0]))?c.loopAsync(d[103],function(a){return d[104]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[90],d[104]).then(function(a){return a=a,d[105]=a[0],d[106]=a[1],a})},function(a){return d[107]=(d[102].push(d[105]),d[102])}])}):c.resolve()},function(a){return d[101]=d[102]}])},function(a){return d[87].set(d[97],d[101])}])},function(a){return d[98]="intent_message_ids",d[92]=d[55].get(d[98]),d[92]?d[93]=!1:d[93]=!0,d[93]?c.resolve():c.sequence([function(a){return d[92]?d[100]=!1:d[100]=!0,d[100]?c.resolve(d[101]=void 0):c.sequence([function(a){return d[102]=c.createArray(),d[103]=c.i64.of_int32(d[92].length),c.i64.gt(d[103],c.i64.cast([0,0]))?c.loopAsync(d[103],function(a){return d[104]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[92],d[104]).then(function(a){return a=a,d[105]=a[0],d[106]=a[1],a})},function(a){return d[107]=(d[102].push(d[105]),d[102])}])}):c.resolve()},function(a){return d[101]=d[102]}])},function(a){return d[87].set(d[98],d[101])}])},function(a){return d[99]="intent_messages",d[94]=d[55].get(d[99]),d[94]?d[95]=!1:d[95]=!0,d[95]?c.resolve():c.sequence([function(a){return d[94]?d[100]=!1:d[100]=!0,d[100]?c.resolve(d[101]=void 0):c.sequence([function(a){return d[102]=c.createArray(),d[103]=c.i64.of_int32(d[94].length),c.i64.gt(d[103],c.i64.cast([0,0]))?c.loopAsync(d[103],function(a){return d[104]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[94],d[104]).then(function(a){return a=a,d[105]=a[0],d[106]=a[1],a})},function(a){return d[107]=(d[102].push(d[105]),d[102])}])}):c.resolve()},function(a){return d[101]=d[102]}])},function(a){return d[87].set(d[99],d[101])}])},function(a){return d[86]=d[87]}])},function(a){return d[23].set(d[83],d[86])}])},function(a){return d[84]="psi_tool_query_data",d[57]=d[6].get(d[84]),d[57]?d[58]=!1:d[58]=!0,d[58]?c.resolve():c.sequence([function(a){return d[57]?d[85]=!1:d[85]=!0,d[85]?c.resolve(d[86]=void 0):c.sequence([function(a){return d[87]=new c.Map(),d[93]="conversation_name",d[88]=d[57].get(d[93]),d[88]!==void 0?d[87].set(d[93],d[88]):0,d[94]="original_query_string",d[89]=d[57].get(d[94]),d[89]!==void 0?d[87].set(d[94],d[89]):0,d[95]="response_message_id",d[90]=d[57].get(d[95]),d[90]!==void 0?d[87].set(d[95],d[90]):0,d[96]="messages",d[91]=d[57].get(d[96]),d[91]?d[92]=!1:d[92]=!0,d[92]?c.resolve():c.sequence([function(a){return d[91]?d[97]=!1:d[97]=!0,d[97]?c.resolve(d[98]=void 0):c.sequence([function(a){return d[99]=c.createArray(),d[100]=c.i64.of_int32(d[91].length),c.i64.gt(d[100],c.i64.cast([0,0]))?c.loopAsync(d[100],function(a){return d[101]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[91],d[101]).then(function(a){return a=a,d[102]=a[0],d[103]=a[1],a})},function(a){return d[104]=new c.Map(),d[112]="message_type",d[105]=d[102].get(d[112]),d[105]!==void 0?d[104].set(d[112],d[105]):0,d[113]="message_sender_name",d[106]=d[102].get(d[113]),d[106]!==void 0?d[104].set(d[113],d[106]):0,d[114]="message_invoker_name",d[107]=d[102].get(d[114]),d[107]!==void 0?d[104].set(d[114],d[107]):0,d[115]="message_timestamp_ms",d[108]=d[102].get(d[115]),d[108]!==void 0?d[104].set(d[115],c.i64.from_string(d[108])):0,d[116]="message_thread_name",d[109]=d[102].get(d[116]),d[109]!==void 0?d[104].set(d[116],d[109]):0,d[117]="message_id",d[110]=d[102].get(d[117]),d[110]!==void 0?d[104].set(d[117],d[110]):0,d[118]="message_text",d[111]=d[102].get(d[118]),d[111]!==void 0?d[104].set(d[118],d[111]):0,d[119]=(d[99].push(d[104]),d[99])}])}):c.resolve()},function(a){return d[98]=d[99]}])},function(a){return d[87].set(d[96],d[98])}])},function(a){return d[86]=d[87]}])},function(a){return d[23].set(d[84],d[86])}])},function(a){return d[22]=d[23]}]):c.sequence([function(a){return d[13]==="XMSGProductHighlightExtras"?c.resolve((d[24]=new c.Map(),d[27]="product_highlight_type",d[25]=d[6].get(d[27]),d[25]!==void 0?d[24].set(d[27],d[25]):0,d[28]="conversation_marker",d[26]=d[6].get(d[28]),d[26]!==void 0?d[24].set(d[28],d[26]):0,d[23]=d[24])):c.sequence([function(a){return d[13]==="XMSGMagicMessengerExtras"?c.resolve((d[25]=new c.Map(),d[27]="is_magic_thread",d[26]=d[6].get(d[27]),d[26]!==void 0?d[25].set(d[27],d[26]):0,d[24]=d[25])):c.sequence([function(a){return d[13]==="XMSGAdsAIExtras"?c.resolve((d[26]=new c.Map(),d[30]="context",d[27]=d[6].get(d[30]),d[27]!==void 0?d[26].set(d[30],d[27]):0,d[31]="is_reply_to_ads_ai",d[28]=d[6].get(d[31]),d[28]!==void 0?d[26].set(d[31],d[28]):0,d[32]="is_message_processed_by_lightspeed",d[29]=d[6].get(d[32]),d[29]!==void 0?d[26].set(d[32],d[29]):0,d[25]=d[26])):c.sequence([function(a){return d[13]==="XMSGBizappExtras"?c.resolve((d[27]=new c.Map(),d[30]="message_source",d[28]=d[6].get(d[30]),d[28]!==void 0?d[27].set(d[30],d[28]):0,d[31]="message_trigger",d[29]=d[6].get(d[31]),d[29]!==void 0?d[27].set(d[31],d[29]):0,d[26]=d[27])):c.sequence([function(a){return d[27]=new c.Map(),d[28]=d[6].keys(),d[29]=c.i64.of_int32(d[28].length),c.i64.gt(d[29],c.i64.cast([0,0]))?c.loopAsync(d[29],function(a){return d[30]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[28],d[30]).then(function(a){return a=a,d[31]=a[0],d[32]=a[1],a})},function(a){return d[33]=d[6].get(d[31]),d[27].set(d[31],d[33])}])}):c.resolve()},function(a){return d[26]=d[27]}])},function(a){return d[25]=d[26]}])},function(a){return d[24]=d[25]}])},function(a){return d[23]=d[24]}])},function(a){return d[22]=d[23]}])},function(a){return d[21]=d[22]}])},function(a){return d[20]=d[21]}])},function(a){return d[19]=d[20]}])},function(a){return d[18]=d[19]}])},function(a){return d[17]=d[18]}])},function(a){return d[16]=d[17]}])},function(a){return d[15]=d[16]}])},function(a){return d[14]=d[15]}])},function(a){return d[14].set("__typename",d[13]),d[12]=d[14]}])},function(a){return d[4].set(d[10],d[12])}])},function(a){return d[8]=d[4].get("product_type"),d[0]=d[8]}]):c.resolve(d[0]=void 0)},function(e){return c.i64.eq(a[1],c.i64.cast([0,7]))?c.resolve((e=[a[0],c.i64.cast([0,1024])],d[1]=e[0],d[2]=e[1],e)):c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(c.i64.eq(a[0],c.i64.cast([0,0]))?d[12]=a[0]:d[12]=void 0,f=[d[12],void 0,c.i64.cast([0,20])],d[3]=f[0],d[4]=f[1],d[5]=f[2]):(e=b.item,f=[e.threadKey,e.clientThreadKey,e.authorityLevel],d[3]=f[0],d[4]=f[1],d[5]=f[2])})},function(e){return d[12]=c.i64.of_int32(a[6].length),c.i64.eq(a[1],c.i64.cast([0,1]))&&c.i64.gt(d[12],c.i64.cast([0,0]))?(d[13]=c.i64.of_int32(a[6].length),c.i64.gt(d[13],c.i64.cast([0,0]))?c.loopAsync(d[13],function(e){return d[14]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[6],d[14]).then(function(a){return a=a,d[15]=a[0],d[16]=a[1],a})},function(a){return d[17]=d[15].get("contact_id"),d[18]=d[15].get("contact_type"),d[19]=d[15].get("contact_name"),d[20]=d[15].get("contact_profile_photo"),c.storedProcedure(b("LSVerifyContactRowExists"),d[17],c.i64.cast([0,0]),d[20],d[19],d[18],void 0,void 0,void 0,void 0,!1,!1,c.i64.cast([0,0]),void 0,!1,c.i64.cast([0,20]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,2]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,5]))}])}):c.resolve()):c.resolve()},function(e){return a[5]!==void 0?c.sequence([function(d){return c.storedProcedure(b("LSMessagePointQuery"),a[0],a[5],a[1],void 0)},function(b){return b=[a[0],void 0],d[7]=b[0],d[8]=b[1],b}]):c.sequence([function(e){return(c.i64.eq(a[1],c.i64.cast([0,2]))||c.i64.eq(a[1],c.i64.cast([0,5]))||d[0]==="CTM")&&c.i64.eq(a[0],c.i64.cast([0,0]))?c.sequence([function(e){return d[14]=c.createArray(),d[15]=c.i64.of_int32(a[6].length),c.i64.gt(d[15],c.i64.cast([0,0]))?c.loopAsync(d[15],function(e){return d[28]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[6],d[28]).then(function(a){return a=a,d[29]=a[0],d[30]=a[1],a})},function(a){return d[31]=d[29].get("contact_id"),d[32]=d[29].get("contact_type"),d[33]=d[29].get("contact_name"),d[34]=d[29].get("contact_profile_photo"),d[35]=(d[14].push(d[31]),d[14])}])}):c.resolve()},function(a){return d[16]=c.i64.of_int32(d[14].length),d[17]=c.createArray(),c.sequence([function(a){return d[28]=c.createArray(),d[29]=c.i64.of_int32(d[14].length),c.i64.gt(d[29],c.i64.cast([0,0]))?c.loopAsync(d[29],function(a){return d[31]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[14],d[31]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],a})},function(a){return d[34]=(d[28].push(c.i64.to_string(d[32])),d[28])}])}):c.resolve()},function(a){return d[30]=d[28].join(","),d[18]=d[30]}])},function(a){return c.groupBy(c.filter(c.db.table(14).fetch(),function(a){return d[14].some(function(b){return c.i64.eq(a.contactId,b)})}),"threadKey").forEach(function(a){return c.i64.eq(a.group_count,d[16])?d[28]=(d[17].push(a.threadKey),d[17]):0})},function(a){return d[19]=c.createArray(),c.sequence([function(a){return d[28]=c.createArray(),d[29]=c.i64.of_int32(d[17].length),c.i64.gt(d[29],c.i64.cast([0,0]))?c.loopAsync(d[29],function(a){return d[31]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[17],d[31]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],a})},function(a){return d[34]=(d[28].push(c.i64.to_string(d[32])),d[28])}])}):c.resolve()},function(a){return d[30]=d[28].join(","),d[20]=d[30]}])},function(a){return c.groupBy(c.filter(c.db.table(14).fetch(),function(a){return d[17].some(function(b){return c.i64.eq(a.threadKey,b)})}),"threadKey").forEach(function(a){return c.i64.eq(a.group_count,d[16])?d[28]=(d[19].push(a.threadKey),d[19]):0})},function(a){return c.sequence([function(a){return d[28]=c.createArray(),d[29]=c.i64.of_int32(d[19].length),c.i64.gt(d[29],c.i64.cast([0,0]))?c.loopAsync(d[29],function(a){return d[31]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],d[31]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],a})},function(a){return d[34]=(d[28].push(c.i64.to_string(d[32])),d[28])}])}):c.resolve()},function(a){return d[30]=d[28].join(","),d[21]=d[30]}])},function(b){return c.islc(c.filter(c.db.table(9).fetchDesc([[[c.merge({lt:c.i64.cast([0,5])},a[1])],[c.merge({gt:c.i64.cast([0,5])},a[1])],[c.merge(c.i64.cast([0,5]),a[1])]],"threadTypeLastActivityTimestampMs"]),function(b){return d[19].some(function(a){return c.i64.eq(b.threadKey,a)})&&(c.i64.neq(b.threadType,c.i64.cast([0,5]))&&b.threadName===void 0||c.i64.eq(b.threadType,c.i64.cast([0,5]))&&b.threadName===a[2])&&c.i64.eq(b.threadType,a[1])}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(e=[void 0,void 0,c.i64.cast([0,20])],d[22]=e[0],d[23]=e[1],d[24]=e[2],e):(b=a.item,e=[b.threadKey,b.clientThreadKey,b.authorityLevel],d[22]=e[0],d[23]=e[1],d[24]=e[2])})},function(e){return c.i64.neq(d[22],void 0)?c.sequence([function(e){return d[0]==="CTM"?c.sequence([function(e){return a[8]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[8]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[39]=new c.Map(),d[45]="product_type",d[40]=d[38].get(d[45]),d[40]!==void 0?d[39].set(d[45],d[40]):0,d[46]="product_extras",d[41]=d[38].get(d[46]),d[41]?d[42]=!1:d[42]=!0,d[42]?c.resolve():c.sequence([function(a){return d[41]?d[47]=!1:d[47]=!0,d[47]?c.resolve(d[48]=void 0):c.sequence([function(a){return d[49]=d[41].get("__typename"),d[49]==="XMSGStoryReplyExtras"?c.resolve((d[51]=new c.Map(),d[54]="logging",d[52]=d[41].get(d[54]),d[52]?d[53]=!1:d[53]=!0,d[53]?0:(d[52]?d[55]=!1:d[55]=!0,d[55]?d[56]=void 0:(d[57]=new c.Map(),d[65]="story_author_fbid",d[58]=d[52].get(d[65]),d[58]!==void 0?d[57].set(d[65],d[58]):0,d[66]="camera_post_type",d[59]=d[52].get(d[66]),d[59]!==void 0?d[57].set(d[66],d[59]):0,d[67]="story_type",d[60]=d[52].get(d[67]),d[60]!==void 0?d[57].set(d[67],d[60]):0,d[68]="post_source",d[61]=d[52].get(d[68]),d[61]!==void 0?d[57].set(d[68],d[61]):0,d[69]="fb_post_type",d[62]=d[52].get(d[69]),d[62]!==void 0?d[57].set(d[69],d[62]):0,d[70]="conversation_starter_type",d[63]=d[52].get(d[70]),d[63]!==void 0?d[57].set(d[70],d[63]):0,d[71]="story_reply_type",d[64]=d[52].get(d[71]),d[64]!==void 0?d[57].set(d[71],d[64]):0,d[56]=d[57]),d[51].set(d[54],d[56])),d[50]=d[51])):c.sequence([function(a){return d[49]==="XMSGMarketplaceExtras"?c.sequence([function(a){return d[52]=new c.Map(),d[71]="listing_id",d[53]=d[41].get(d[71]),d[53]!==void 0?d[52].set(d[71],d[53]):0,d[72]="initial_clicked_component",d[54]=d[41].get(d[72]),d[54]!==void 0?d[52].set(d[72],d[54]):0,d[73]="initial_tracking",d[55]=d[41].get(d[73]),d[55]!==void 0?d[52].set(d[73],d[55]):0,d[74]="referral_surface",d[56]=d[41].get(d[74]),d[56]!==void 0?d[52].set(d[74],d[56]):0,d[75]="referral_story_type",d[57]=d[41].get(d[75]),d[57]!==void 0?d[52].set(d[75],d[57]):0,d[76]="referral_ui_component",d[58]=d[41].get(d[76]),d[58]!==void 0?d[52].set(d[76],d[58]):0,d[77]="surface",d[59]=d[41].get(d[77]),d[59]!==void 0?d[52].set(d[77],d[59]):0,d[78]="tracking",d[60]=d[41].get(d[78]),d[60]!==void 0?d[52].set(d[78],d[60]):0,d[79]="ui_component",d[61]=d[41].get(d[79]),d[61]!==void 0?d[52].set(d[79],d[61]):0,d[80]="ad_id",d[62]=d[41].get(d[80]),d[62]!==void 0?d[52].set(d[80],d[62]):0,d[81]="server_session_id",d[63]=d[41].get(d[81]),d[63]!==void 0?d[52].set(d[81],d[63]):0,d[82]="cf_page_id",d[64]=d[41].get(d[82]),d[64]!==void 0?d[52].set(d[82],d[64]):0,d[83]="live_shopping_video_id",d[65]=d[41].get(d[83]),d[65]!==void 0?d[52].set(d[83],d[65]):0,d[84]="logging_id",d[66]=d[41].get(d[84]),c.i64.neq(d[66],void 0)?d[52].set(d[84],d[66]):0,d[85]="photo_ids",d[67]=d[41].get(d[85]),d[67]?d[68]=!1:d[68]=!0,d[68]?c.resolve():c.sequence([function(a){return d[88]=c.createArray(),d[89]=c.i64.of_int32(d[67].length),c.i64.gt(d[89],c.i64.cast([0,0]))?c.loopAsync(d[89],function(a){return d[90]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[67],d[90]).then(function(a){return a=a,d[91]=a[0],d[92]=a[1],a})},function(a){return d[93]=(d[88].push(d[91]),d[88])}])}):c.resolve()},function(a){return d[52].set(d[85],d[88])}])},function(a){return d[86]="is_customized_message",d[69]=d[41].get(d[86]),d[69]!==void 0?d[52].set(d[86],d[69]):0,d[87]="referral_code",d[70]=d[41].get(d[87]),d[70]!==void 0?d[52].set(d[87],d[70]):0,d[51]=d[52]}]):c.sequence([function(a){return d[49]==="XMSGClickToMessengerAdExtras"?c.resolve((d[53]=new c.Map(),d[64]="encrypted_ads_token",d[54]=d[41].get(d[64]),d[54]!==void 0?d[53].set(d[64],d[54]):0,d[65]="product_type",d[55]=d[41].get(d[65]),d[55]!==void 0?d[53].set(d[65],d[55]):0,d[66]="post_id",d[56]=d[41].get(d[66]),d[56]!==void 0?d[53].set(d[66],d[56]):0,d[67]="ad_id",d[57]=d[41].get(d[67]),d[57]!==void 0?d[53].set(d[67],d[57]):0,d[68]="page_id",d[58]=d[41].get(d[68]),d[58]!==void 0?d[53].set(d[68],d[58]):0,d[69]="photo_id",d[59]=d[41].get(d[69]),d[59]!==void 0?d[53].set(d[69],d[59]):0,d[70]="photo_index",d[60]=d[41].get(d[70]),c.i64.neq(d[60],void 0)?d[53].set(d[70],d[60]):0,d[71]="fallback_url",d[61]=d[41].get(d[71]),d[61]!==void 0?d[53].set(d[71],d[61]):0,d[72]="product_id",d[62]=d[41].get(d[72]),d[62]!==void 0?d[53].set(d[72],d[62]):0,d[73]="user_id",d[63]=d[41].get(d[73]),d[63]!==void 0?d[53].set(d[73],d[63]):0,d[52]=d[53])):c.sequence([function(a){return d[49]==="XMSGZorroMessageExtras"?c.resolve((d[54]=new c.Map(),d[56]="is_enabled",d[55]=d[41].get(d[56]),d[55]!==void 0?d[54].set(d[56],d[55]):0,d[53]=d[54])):c.sequence([function(a){return d[49]==="XMSGGenAISuggestedPromptExtras"?c.resolve((d[55]=new c.Map(),d[58]="prompt_type",d[56]=d[41].get(d[58]),d[56]!==void 0?d[55].set(d[58],d[56]):0,d[59]="qpl_join_id",d[57]=d[41].get(d[59]),d[57]!==void 0?d[55].set(d[59],d[57]):0,d[54]=d[55])):c.sequence([function(a){return d[49]==="XMSGGenAIMultiModalExtras"?c.resolve((d[56]=new c.Map(),d[60]="should_skip_genai_eval",d[57]=d[41].get(d[60]),d[57]!==void 0?d[56].set(d[60],d[57]):0,d[61]="associated_multimodal_message_id",d[58]=d[41].get(d[61]),d[58]!==void 0?d[56].set(d[61],d[58]):0,d[62]="qpl_join_id",d[59]=d[41].get(d[62]),d[59]!==void 0?d[56].set(d[62],d[59]):0,d[55]=d[56])):c.sequence([function(a){return d[49]==="XMSGGenAIFlashImagineExtras"?c.resolve((d[57]=new c.Map(),d[60]="seed",d[58]=d[41].get(d[60]),c.i64.neq(d[58],void 0)?d[57].set(d[60],d[58]):0,d[61]="qpl_join_id",d[59]=d[41].get(d[61]),d[59]!==void 0?d[57].set(d[61],d[59]):0,d[56]=d[57])):c.sequence([function(a){return d[49]==="XMSGShareSheetExtras"?c.resolve((d[58]=new c.Map(),d[60]="recipient_selection_session_id",d[59]=d[41].get(d[60]),d[59]!==void 0?d[58].set(d[60],d[59]):0,d[57]=d[58])):c.sequence([function(a){return d[49]==="XMSGGenAIAssistantAPIExtras"?c.sequence([function(a){return d[59]=new c.Map(),d[95]="referrer_session_id",d[60]=d[41].get(d[95]),d[60]!==void 0?d[59].set(d[95],d[60]):0,d[96]="thread_session_id",d[61]=d[41].get(d[96]),d[61]!==void 0?d[59].set(d[96],d[61]):0,d[97]="prompt_id",d[62]=d[41].get(d[97]),d[62]!==void 0?d[59].set(d[97],d[62]):0,d[98]="prompt_type",d[63]=d[41].get(d[98]),d[63]!==void 0?d[59].set(d[98],d[63]):0,d[99]="prompt_fit_topic",d[64]=d[41].get(d[99]),d[64]!==void 0?d[59].set(d[99],d[64]):0,d[100]="location_extras",d[65]=d[41].get(d[100]),d[65]?d[66]=!1:d[66]=!0,d[66]?0:(d[65]?d[121]=!1:d[121]=!0,d[121]?d[122]=void 0:(d[123]=new c.Map(),d[127]="has_previous_perm_prompt",d[124]=d[65].get(d[127]),d[124]!==void 0?d[123].set(d[127],d[124]):0,d[128]="latitude",d[125]=d[65].get(d[128]),d[125]!==void 0?d[123].set(d[128],d[125]):0,d[129]="longitude",d[126]=d[65].get(d[129]),d[126]!==void 0?d[123].set(d[129],d[126]):0,d[122]=d[123]),d[59].set(d[100],d[122])),d[101]="qpl_join_id",d[67]=d[41].get(d[101]),d[67]!==void 0?d[59].set(d[101],d[67]):0,d[102]="meta_ai_prompt_type",d[68]=d[41].get(d[102]),d[68]!==void 0?d[59].set(d[102],d[68]):0,d[103]="is_subsequent_send",d[69]=d[41].get(d[103]),d[69]!==void 0?d[59].set(d[103],d[69]):0,d[104]="context_injection_type",d[70]=d[41].get(d[104]),d[70]!==void 0?d[59].set(d[104],d[70]):0,d[105]="context_injection_timestamp_ms",d[71]=d[41].get(d[105]),d[71]!==void 0?d[59].set(d[105],d[71]):0,d[106]="meta_ai_response_to_persist",d[72]=d[41].get(d[106]),d[72]?d[73]=!1:d[73]=!0,d[73]?c.resolve():c.sequence([function(a){return d[72]?d[121]=!1:d[121]=!0,d[121]?c.resolve(d[122]=void 0):c.sequence([function(a){return d[123]=new c.Map(),d[130]="text",d[124]=d[72].get(d[130]),d[124]!==void 0?d[123].set(d[130],d[124]):0,d[131]="bot_response_id",d[125]=d[72].get(d[131]),d[125]!==void 0?d[123].set(d[131],d[125]):0,d[132]="bot_request_id",d[126]=d[72].get(d[132]),d[126]!==void 0?d[123].set(d[132],d[126]):0,d[133]="external_search_params",d[127]=d[72].get(d[133]),d[127]?d[128]=!1:d[128]=!0,d[128]?c.resolve():c.sequence([function(a){return d[127]?d[135]=!1:d[135]=!0,d[135]?c.resolve(d[136]=void 0):c.sequence([function(a){return d[137]=new c.Map(),d[145]="search_result_uri",d[138]=d[127].get(d[145]),d[138]?d[139]=!1:d[139]=!0,d[139]?c.resolve():c.sequence([function(a){return d[138]?d[150]=!1:d[150]=!0,d[150]?c.resolve(d[151]=void 0):c.sequence([function(a){return d[152]=c.createArray(),d[153]=c.i64.of_int32(d[138].length),c.i64.gt(d[153],c.i64.cast([0,0]))?c.loopAsync(d[153],function(a){return d[154]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[138],d[154]).then(function(a){return a=a,d[155]=a[0],d[156]=a[1],a})},function(a){return d[157]=(d[152].push(d[155]),d[152])}])}):c.resolve()},function(a){return d[151]=d[152]}])},function(a){return d[137].set(d[145],d[151])}])},function(a){return d[146]="search_query",d[140]=d[127].get(d[146]),d[140]!==void 0?d[137].set(d[146],d[140]):0,d[147]="attribution_link",d[141]=d[127].get(d[147]),d[141]!==void 0?d[137].set(d[147],d[141]):0,d[148]="search_engine",d[142]=d[127].get(d[148]),d[142]!==void 0?d[137].set(d[148],d[142]):0,d[149]="references_title",d[143]=d[127].get(d[149]),d[143]?d[144]=!1:d[144]=!0,d[144]?c.resolve():c.sequence([function(a){return d[143]?d[150]=!1:d[150]=!0,d[150]?c.resolve(d[151]=void 0):c.sequence([function(a){return d[152]=c.createArray(),d[153]=c.i64.of_int32(d[143].length),c.i64.gt(d[153],c.i64.cast([0,0]))?c.loopAsync(d[153],function(a){return d[154]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[143],d[154]).then(function(a){return a=a,d[155]=a[0],d[156]=a[1],a})},function(a){return d[157]=(d[152].push(d[155]),d[152])}])}):c.resolve()},function(a){return d[151]=d[152]}])},function(a){return d[137].set(d[149],d[151])}])},function(a){return d[136]=d[137]}])},function(a){return d[123].set(d[133],d[136])}])},function(a){return d[134]="followup_prompt_text",d[129]=d[72].get(d[134]),d[129]!==void 0?d[123].set(d[134],d[129]):0,d[122]=d[123]}])},function(a){return d[59].set(d[106],d[122])}])},function(a){return d[107]="gql_dark_test_qpl_join_id",d[74]=d[41].get(d[107]),d[74]!==void 0?d[59].set(d[107],d[74]):0,d[108]="gql_dark_test_client_start_time",d[75]=d[41].get(d[108]),d[75]!==void 0?d[59].set(d[108],d[75]):0,d[109]="prompt_context",d[76]=d[41].get(d[109]),d[76]?d[77]=!1:d[77]=!0,d[77]?0:(d[76]?d[121]=!1:d[121]=!0,d[121]?d[122]=void 0:(d[123]=new c.Map(),d[126]="context_token",d[124]=d[76].get(d[126]),d[124]!==void 0?d[123].set(d[126],d[124]):0,d[127]="context_token_type",d[125]=d[76].get(d[127]),c.i64.neq(d[125],void 0)?d[123].set(d[127],d[125]):0,d[122]=d[123]),d[59].set(d[109],d[122])),d[110]="imagine_flash_extras",d[78]=d[41].get(d[110]),d[78]?d[79]=!1:d[79]=!0,d[79]?0:(d[78]?d[121]=!1:d[121]=!0,d[121]?d[122]=void 0:(d[123]=new c.Map(),d[126]="seed",d[124]=d[78].get(d[126]),c.i64.neq(d[124],void 0)?d[123].set(d[126],d[124]):0,d[127]="qpl_join_id",d[125]=d[78].get(d[127]),d[125]!==void 0?d[123].set(d[127],d[125]):0,d[122]=d[123]),d[59].set(d[110],d[122])),d[111]="conversation_marker_id",d[80]=d[41].get(d[111]),d[80]!==void 0?d[59].set(d[111],d[80]):0,d[112]="multi_modal_extras",d[81]=d[41].get(d[112]),d[81]?d[82]=!1:d[82]=!0,d[82]?0:(d[81]?d[121]=!1:d[121]=!0,d[121]?d[122]=void 0:(d[123]=new c.Map(),d[127]="should_skip_genai_eval",d[124]=d[81].get(d[127]),d[124]!==void 0?d[123].set(d[127],d[124]):0,d[128]="associated_multimodal_message_id",d[125]=d[81].get(d[128]),d[125]!==void 0?d[123].set(d[128],d[125]):0,d[129]="qpl_join_id",d[126]=d[81].get(d[129]),d[126]!==void 0?d[123].set(d[129],d[126]):0,d[122]=d[123]),d[59].set(d[112],d[122])),d[113]="ads_extras",d[83]=d[41].get(d[113]),d[83]?d[84]=!1:d[84]=!0,d[84]?0:(d[83]?d[121]=!1:d[121]=!0,d[121]?d[122]=void 0:(d[123]=new c.Map(),d[127]="context",d[124]=d[83].get(d[127]),d[124]!==void 0?d[123].set(d[127],d[124]):0,d[128]="is_reply_to_ads_ai",d[125]=d[83].get(d[128]),d[125]!==void 0?d[123].set(d[128],d[125]):0,d[129]="is_message_processed_by_lightspeed",d[126]=d[83].get(d[129]),d[126]!==void 0?d[123].set(d[129],d[126]):0,d[122]=d[123]),d[59].set(d[113],d[122])),d[114]="suggested_prompt_extras",d[85]=d[41].get(d[114]),d[85]?d[86]=!1:d[86]=!0,d[86]?0:(d[85]?d[121]=!1:d[121]=!0,d[121]?d[122]=void 0:(d[123]=new c.Map(),d[126]="prompt_type",d[124]=d[85].get(d[126]),d[124]!==void 0?d[123].set(d[126],d[124]):0,d[127]="qpl_join_id",d[125]=d[85].get(d[127]),d[125]!==void 0?d[123].set(d[127],d[125]):0,d[122]=d[123]),d[59].set(d[114],d[122])),d[115]="disable_server_mqtt_typing_indicator",d[87]=d[41].get(d[115]),d[87]!==void 0?d[59].set(d[115],d[87]):0,d[116]="enable_web_scraping",d[88]=d[41].get(d[116]),d[88]!==void 0?d[59].set(d[116],d[88]):0,d[117]="client_prompt_timestamp",d[89]=d[41].get(d[117]),d[89]!==void 0?(d[89]!==void 0?d[121]=c.i64.from_string(d[89]):d[121]=void 0,d[59].set(d[117],d[121])):0,d[118]="is_client_ready_for_psi",d[90]=d[41].get(d[118]),d[90]!==void 0?d[59].set(d[118],d[90]):0,d[119]="intent_detection_extras",d[91]=d[41].get(d[119]),d[91]?d[92]=!1:d[92]=!0,d[92]?c.resolve():c.sequence([function(a){return d[91]?d[121]=!1:d[121]=!0,d[121]?c.resolve(d[122]=void 0):c.sequence([function(a){return d[123]=new c.Map(),d[132]="intent_messages_metadata",d[124]=d[91].get(d[132]),d[124]?d[125]=!1:d[125]=!0,d[125]?c.resolve():c.sequence([function(a){return d[124]?d[136]=!1:d[136]=!0,d[136]?c.resolve(d[137]=void 0):c.sequence([function(a){return d[138]=c.createArray(),d[139]=c.i64.of_int32(d[124].length),c.i64.gt(d[139],c.i64.cast([0,0]))?c.loopAsync(d[139],function(a){return d[140]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[124],d[140]).then(function(a){return a=a,d[141]=a[0],d[142]=a[1],a})},function(a){return d[143]=new c.Map(),d[151]="message_type",d[144]=d[141].get(d[151]),d[144]!==void 0?d[143].set(d[151],d[144]):0,d[152]="message_sender_name",d[145]=d[141].get(d[152]),d[145]!==void 0?d[143].set(d[152],d[145]):0,d[153]="message_invoker_name",d[146]=d[141].get(d[153]),d[146]!==void 0?d[143].set(d[153],d[146]):0,d[154]="message_timestamp_ms",d[147]=d[141].get(d[154]),d[147]!==void 0?d[143].set(d[154],c.i64.from_string(d[147])):0,d[155]="message_thread_name",d[148]=d[141].get(d[155]),d[148]!==void 0?d[143].set(d[155],d[148]):0,d[156]="message_id",d[149]=d[141].get(d[156]),d[149]!==void 0?d[143].set(d[156],d[149]):0,d[157]="message_text",d[150]=d[141].get(d[157]),d[150]!==void 0?d[143].set(d[157],d[150]):0,d[158]=(d[138].push(d[143]),d[138])}])}):c.resolve()},function(a){return d[137]=d[138]}])},function(a){return d[123].set(d[132],d[137])}])},function(a){return d[133]="intent_types",d[126]=d[91].get(d[133]),d[126]?d[127]=!1:d[127]=!0,d[127]?c.resolve():c.sequence([function(a){return d[126]?d[136]=!1:d[136]=!0,d[136]?c.resolve(d[137]=void 0):c.sequence([function(a){return d[138]=c.createArray(),d[139]=c.i64.of_int32(d[126].length),c.i64.gt(d[139],c.i64.cast([0,0]))?c.loopAsync(d[139],function(a){return d[140]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[126],d[140]).then(function(a){return a=a,d[141]=a[0],d[142]=a[1],a})},function(a){return d[143]=(d[138].push(d[141]),d[138])}])}):c.resolve()},function(a){return d[137]=d[138]}])},function(a){return d[123].set(d[133],d[137])}])},function(a){return d[134]="intent_message_ids",d[128]=d[91].get(d[134]),d[128]?d[129]=!1:d[129]=!0,d[129]?c.resolve():c.sequence([function(a){return d[128]?d[136]=!1:d[136]=!0,d[136]?c.resolve(d[137]=void 0):c.sequence([function(a){return d[138]=c.createArray(),d[139]=c.i64.of_int32(d[128].length),c.i64.gt(d[139],c.i64.cast([0,0]))?c.loopAsync(d[139],function(a){return d[140]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[128],d[140]).then(function(a){return a=a,d[141]=a[0],d[142]=a[1],a})},function(a){return d[143]=(d[138].push(d[141]),d[138])}])}):c.resolve()},function(a){return d[137]=d[138]}])},function(a){return d[123].set(d[134],d[137])}])},function(a){return d[135]="intent_messages",d[130]=d[91].get(d[135]),d[130]?d[131]=!1:d[131]=!0,d[131]?c.resolve():c.sequence([function(a){return d[130]?d[136]=!1:d[136]=!0,d[136]?c.resolve(d[137]=void 0):c.sequence([function(a){return d[138]=c.createArray(),d[139]=c.i64.of_int32(d[130].length),c.i64.gt(d[139],c.i64.cast([0,0]))?c.loopAsync(d[139],function(a){return d[140]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[130],d[140]).then(function(a){return a=a,d[141]=a[0],d[142]=a[1],a})},function(a){return d[143]=(d[138].push(d[141]),d[138])}])}):c.resolve()},function(a){return d[137]=d[138]}])},function(a){return d[123].set(d[135],d[137])}])},function(a){return d[122]=d[123]}])},function(a){return d[59].set(d[119],d[122])}])},function(a){return d[120]="psi_tool_query_data",d[93]=d[41].get(d[120]),d[93]?d[94]=!1:d[94]=!0,d[94]?c.resolve():c.sequence([function(a){return d[93]?d[121]=!1:d[121]=!0,d[121]?c.resolve(d[122]=void 0):c.sequence([function(a){return d[123]=new c.Map(),d[129]="conversation_name",d[124]=d[93].get(d[129]),d[124]!==void 0?d[123].set(d[129],d[124]):0,d[130]="original_query_string",d[125]=d[93].get(d[130]),d[125]!==void 0?d[123].set(d[130],d[125]):0,d[131]="response_message_id",d[126]=d[93].get(d[131]),d[126]!==void 0?d[123].set(d[131],d[126]):0,d[132]="messages",d[127]=d[93].get(d[132]),d[127]?d[128]=!1:d[128]=!0,d[128]?c.resolve():c.sequence([function(a){return d[127]?d[133]=!1:d[133]=!0,d[133]?c.resolve(d[134]=void 0):c.sequence([function(a){return d[135]=c.createArray(),d[136]=c.i64.of_int32(d[127].length),c.i64.gt(d[136],c.i64.cast([0,0]))?c.loopAsync(d[136],function(a){return d[137]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[127],d[137]).then(function(a){return a=a,d[138]=a[0],d[139]=a[1],a})},function(a){return d[140]=new c.Map(),d[148]="message_type",d[141]=d[138].get(d[148]),d[141]!==void 0?d[140].set(d[148],d[141]):0,d[149]="message_sender_name",d[142]=d[138].get(d[149]),d[142]!==void 0?d[140].set(d[149],d[142]):0,d[150]="message_invoker_name",d[143]=d[138].get(d[150]),d[143]!==void 0?d[140].set(d[150],d[143]):0,d[151]="message_timestamp_ms",d[144]=d[138].get(d[151]),d[144]!==void 0?d[140].set(d[151],c.i64.from_string(d[144])):0,d[152]="message_thread_name",d[145]=d[138].get(d[152]),d[145]!==void 0?d[140].set(d[152],d[145]):0,d[153]="message_id",d[146]=d[138].get(d[153]),d[146]!==void 0?d[140].set(d[153],d[146]):0,d[154]="message_text",d[147]=d[138].get(d[154]),d[147]!==void 0?d[140].set(d[154],d[147]):0,d[155]=(d[135].push(d[140]),d[135])}])}):c.resolve()},function(a){return d[134]=d[135]}])},function(a){return d[123].set(d[132],d[134])}])},function(a){return d[122]=d[123]}])},function(a){return d[59].set(d[120],d[122])}])},function(a){return d[58]=d[59]}]):c.sequence([function(a){return d[49]==="XMSGProductHighlightExtras"?c.resolve((d[60]=new c.Map(),d[63]="product_highlight_type",d[61]=d[41].get(d[63]),d[61]!==void 0?d[60].set(d[63],d[61]):0,d[64]="conversation_marker",d[62]=d[41].get(d[64]),d[62]!==void 0?d[60].set(d[64],d[62]):0,d[59]=d[60])):c.sequence([function(a){return d[49]==="XMSGMagicMessengerExtras"?c.resolve((d[61]=new c.Map(),d[63]="is_magic_thread",d[62]=d[41].get(d[63]),d[62]!==void 0?d[61].set(d[63],d[62]):0,d[60]=d[61])):c.sequence([function(a){return d[49]==="XMSGAdsAIExtras"?c.resolve((d[62]=new c.Map(),d[66]="context",d[63]=d[41].get(d[66]),d[63]!==void 0?d[62].set(d[66],d[63]):0,d[67]="is_reply_to_ads_ai",d[64]=d[41].get(d[67]),d[64]!==void 0?d[62].set(d[67],d[64]):0,d[68]="is_message_processed_by_lightspeed",d[65]=d[41].get(d[68]),d[65]!==void 0?d[62].set(d[68],d[65]):0,d[61]=d[62])):c.sequence([function(a){return d[49]==="XMSGBizappExtras"?c.resolve((d[63]=new c.Map(),d[66]="message_source",d[64]=d[41].get(d[66]),d[64]!==void 0?d[63].set(d[66],d[64]):0,d[67]="message_trigger",d[65]=d[41].get(d[67]),d[65]!==void 0?d[63].set(d[67],d[65]):0,d[62]=d[63])):c.sequence([function(a){return d[63]=new c.Map(),d[64]=d[41].keys(),d[65]=c.i64.of_int32(d[64].length),c.i64.gt(d[65],c.i64.cast([0,0]))?c.loopAsync(d[65],function(a){return d[66]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[64],d[66]).then(function(a){return a=a,d[67]=a[0],d[68]=a[1],a})},function(a){return d[69]=d[41].get(d[67]),d[63].set(d[67],d[69])}])}):c.resolve()},function(a){return d[62]=d[63]}])},function(a){return d[61]=d[62]}])},function(a){return d[60]=d[61]}])},function(a){return d[59]=d[60]}])},function(a){return d[58]=d[59]}])},function(a){return d[57]=d[58]}])},function(a){return d[56]=d[57]}])},function(a){return d[55]=d[56]}])},function(a){return d[54]=d[55]}])},function(a){return d[53]=d[54]}])},function(a){return d[52]=d[53]}])},function(a){return d[51]=d[52]}])},function(a){return d[50]=d[51]}])},function(a){return d[50].set("__typename",d[49]),d[48]=d[50]}])},function(a){return d[39].set(d[46],d[48])}])},function(a){return d[43]=d[39].get("product_extras"),d[43]!==void 0?(d[47]=d[43].get("__typename"),d[47]==="XMSGClickToMessengerAdExtras"?(d[50]=new c.Map(),d[61]="encrypted_ads_token",d[51]=d[43].get(d[61]),d[51]!==void 0?d[50].set(d[61],d[51]):0,d[62]="product_type",d[52]=d[43].get(d[62]),d[52]!==void 0?d[50].set(d[62],d[52]):0,d[63]="post_id",d[53]=d[43].get(d[63]),d[53]!==void 0?d[50].set(d[63],d[53]):0,d[64]="ad_id",d[54]=d[43].get(d[64]),d[54]!==void 0?d[50].set(d[64],d[54]):0,d[65]="page_id",d[55]=d[43].get(d[65]),d[55]!==void 0?d[50].set(d[65],d[55]):0,d[66]="photo_id",d[56]=d[43].get(d[66]),d[56]!==void 0?d[50].set(d[66],d[56]):0,d[67]="photo_index",d[57]=d[43].get(d[67]),c.i64.neq(d[57],void 0)?d[50].set(d[67],d[57]):0,d[68]="fallback_url",d[58]=d[43].get(d[68]),d[58]!==void 0?d[50].set(d[68],d[58]):0,d[69]="product_id",d[59]=d[43].get(d[69]),d[59]!==void 0?d[50].set(d[69],d[59]):0,d[70]="user_id",d[60]=d[43].get(d[70]),d[60]!==void 0?d[50].set(d[70],d[60]):0,d[48]=d[50]):d[48]=void 0,d[48]!==void 0?(d[50]=d[48].get("page_id"),d[49]=d[50]):d[49]=void 0,d[44]=d[49]):d[44]=void 0,d[30]=d[44]}]):c.resolve(d[30]=void 0)},function(a){return d[31]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[31]).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[33]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[33]).then(function(a){return a=a,d[34]=a[0],a})},function(a){return d[35]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(e){return d[30]!==void 0?d[37]=c.i64.from_string(d[30]):d[37]=d[32],a[8]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[8]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[39]=new c.Map(),d[44]="product_type",d[40]=d[38].get(d[44]),d[40]!==void 0?d[39].set(d[44],d[40]):0,d[45]="product_extras",d[41]=d[38].get(d[45]),d[41]?d[42]=!1:d[42]=!0,d[42]?c.resolve():c.sequence([function(a){return d[41]?d[46]=!1:d[46]=!0,d[46]?c.resolve(d[47]=void 0):c.sequence([function(a){return d[48]=d[41].get("__typename"),d[48]==="XMSGStoryReplyExtras"?c.resolve((d[50]=new c.Map(),d[53]="logging",d[51]=d[41].get(d[53]),d[51]?d[52]=!1:d[52]=!0,d[52]?0:(d[51]?d[54]=!1:d[54]=!0,d[54]?d[55]=void 0:(d[56]=new c.Map(),d[64]="story_author_fbid",d[57]=d[51].get(d[64]),d[57]!==void 0?d[56].set(d[64],d[57]):0,d[65]="camera_post_type",d[58]=d[51].get(d[65]),d[58]!==void 0?d[56].set(d[65],d[58]):0,d[66]="story_type",d[59]=d[51].get(d[66]),d[59]!==void 0?d[56].set(d[66],d[59]):0,d[67]="post_source",d[60]=d[51].get(d[67]),d[60]!==void 0?d[56].set(d[67],d[60]):0,d[68]="fb_post_type",d[61]=d[51].get(d[68]),d[61]!==void 0?d[56].set(d[68],d[61]):0,d[69]="conversation_starter_type",d[62]=d[51].get(d[69]),d[62]!==void 0?d[56].set(d[69],d[62]):0,d[70]="story_reply_type",d[63]=d[51].get(d[70]),d[63]!==void 0?d[56].set(d[70],d[63]):0,d[55]=d[56]),d[50].set(d[53],d[55])),d[49]=d[50])):c.sequence([function(a){return d[48]==="XMSGMarketplaceExtras"?c.sequence([function(a){return d[51]=new c.Map(),d[70]="listing_id",d[52]=d[41].get(d[70]),d[52]!==void 0?d[51].set(d[70],d[52]):0,d[71]="initial_clicked_component",d[53]=d[41].get(d[71]),d[53]!==void 0?d[51].set(d[71],d[53]):0,d[72]="initial_tracking",d[54]=d[41].get(d[72]),d[54]!==void 0?d[51].set(d[72],d[54]):0,d[73]="referral_surface",d[55]=d[41].get(d[73]),d[55]!==void 0?d[51].set(d[73],d[55]):0,d[74]="referral_story_type",d[56]=d[41].get(d[74]),d[56]!==void 0?d[51].set(d[74],d[56]):0,d[75]="referral_ui_component",d[57]=d[41].get(d[75]),d[57]!==void 0?d[51].set(d[75],d[57]):0,d[76]="surface",d[58]=d[41].get(d[76]),d[58]!==void 0?d[51].set(d[76],d[58]):0,d[77]="tracking",d[59]=d[41].get(d[77]),d[59]!==void 0?d[51].set(d[77],d[59]):0,d[78]="ui_component",d[60]=d[41].get(d[78]),d[60]!==void 0?d[51].set(d[78],d[60]):0,d[79]="ad_id",d[61]=d[41].get(d[79]),d[61]!==void 0?d[51].set(d[79],d[61]):0,d[80]="server_session_id",d[62]=d[41].get(d[80]),d[62]!==void 0?d[51].set(d[80],d[62]):0,d[81]="cf_page_id",d[63]=d[41].get(d[81]),d[63]!==void 0?d[51].set(d[81],d[63]):0,d[82]="live_shopping_video_id",d[64]=d[41].get(d[82]),d[64]!==void 0?d[51].set(d[82],d[64]):0,d[83]="logging_id",d[65]=d[41].get(d[83]),c.i64.neq(d[65],void 0)?d[51].set(d[83],d[65]):0,d[84]="photo_ids",d[66]=d[41].get(d[84]),d[66]?d[67]=!1:d[67]=!0,d[67]?c.resolve():c.sequence([function(a){return d[87]=c.createArray(),d[88]=c.i64.of_int32(d[66].length),c.i64.gt(d[88],c.i64.cast([0,0]))?c.loopAsync(d[88],function(a){return d[89]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[66],d[89]).then(function(a){return a=a,d[90]=a[0],d[91]=a[1],a})},function(a){return d[92]=(d[87].push(d[90]),d[87])}])}):c.resolve()},function(a){return d[51].set(d[84],d[87])}])},function(a){return d[85]="is_customized_message",d[68]=d[41].get(d[85]),d[68]!==void 0?d[51].set(d[85],d[68]):0,d[86]="referral_code",d[69]=d[41].get(d[86]),d[69]!==void 0?d[51].set(d[86],d[69]):0,d[50]=d[51]}]):c.sequence([function(a){return d[48]==="XMSGClickToMessengerAdExtras"?c.resolve((d[52]=new c.Map(),d[63]="encrypted_ads_token",d[53]=d[41].get(d[63]),d[53]!==void 0?d[52].set(d[63],d[53]):0,d[64]="product_type",d[54]=d[41].get(d[64]),d[54]!==void 0?d[52].set(d[64],d[54]):0,d[65]="post_id",d[55]=d[41].get(d[65]),d[55]!==void 0?d[52].set(d[65],d[55]):0,d[66]="ad_id",d[56]=d[41].get(d[66]),d[56]!==void 0?d[52].set(d[66],d[56]):0,d[67]="page_id",d[57]=d[41].get(d[67]),d[57]!==void 0?d[52].set(d[67],d[57]):0,d[68]="photo_id",d[58]=d[41].get(d[68]),d[58]!==void 0?d[52].set(d[68],d[58]):0,d[69]="photo_index",d[59]=d[41].get(d[69]),c.i64.neq(d[59],void 0)?d[52].set(d[69],d[59]):0,d[70]="fallback_url",d[60]=d[41].get(d[70]),d[60]!==void 0?d[52].set(d[70],d[60]):0,d[71]="product_id",d[61]=d[41].get(d[71]),d[61]!==void 0?d[52].set(d[71],d[61]):0,d[72]="user_id",d[62]=d[41].get(d[72]),d[62]!==void 0?d[52].set(d[72],d[62]):0,d[51]=d[52])):c.sequence([function(a){return d[48]==="XMSGZorroMessageExtras"?c.resolve((d[53]=new c.Map(),d[55]="is_enabled",d[54]=d[41].get(d[55]),d[54]!==void 0?d[53].set(d[55],d[54]):0,d[52]=d[53])):c.sequence([function(a){return d[48]==="XMSGGenAISuggestedPromptExtras"?c.resolve((d[54]=new c.Map(),d[57]="prompt_type",d[55]=d[41].get(d[57]),d[55]!==void 0?d[54].set(d[57],d[55]):0,d[58]="qpl_join_id",d[56]=d[41].get(d[58]),d[56]!==void 0?d[54].set(d[58],d[56]):0,d[53]=d[54])):c.sequence([function(a){return d[48]==="XMSGGenAIMultiModalExtras"?c.resolve((d[55]=new c.Map(),d[59]="should_skip_genai_eval",d[56]=d[41].get(d[59]),d[56]!==void 0?d[55].set(d[59],d[56]):0,d[60]="associated_multimodal_message_id",d[57]=d[41].get(d[60]),d[57]!==void 0?d[55].set(d[60],d[57]):0,d[61]="qpl_join_id",d[58]=d[41].get(d[61]),d[58]!==void 0?d[55].set(d[61],d[58]):0,d[54]=d[55])):c.sequence([function(a){return d[48]==="XMSGGenAIFlashImagineExtras"?c.resolve((d[56]=new c.Map(),d[59]="seed",d[57]=d[41].get(d[59]),c.i64.neq(d[57],void 0)?d[56].set(d[59],d[57]):0,d[60]="qpl_join_id",d[58]=d[41].get(d[60]),d[58]!==void 0?d[56].set(d[60],d[58]):0,d[55]=d[56])):c.sequence([function(a){return d[48]==="XMSGShareSheetExtras"?c.resolve((d[57]=new c.Map(),d[59]="recipient_selection_session_id",d[58]=d[41].get(d[59]),d[58]!==void 0?d[57].set(d[59],d[58]):0,d[56]=d[57])):c.sequence([function(a){return d[48]==="XMSGGenAIAssistantAPIExtras"?c.sequence([function(a){return d[58]=new c.Map(),d[94]="referrer_session_id",d[59]=d[41].get(d[94]),d[59]!==void 0?d[58].set(d[94],d[59]):0,d[95]="thread_session_id",d[60]=d[41].get(d[95]),d[60]!==void 0?d[58].set(d[95],d[60]):0,d[96]="prompt_id",d[61]=d[41].get(d[96]),d[61]!==void 0?d[58].set(d[96],d[61]):0,d[97]="prompt_type",d[62]=d[41].get(d[97]),d[62]!==void 0?d[58].set(d[97],d[62]):0,d[98]="prompt_fit_topic",d[63]=d[41].get(d[98]),d[63]!==void 0?d[58].set(d[98],d[63]):0,d[99]="location_extras",d[64]=d[41].get(d[99]),d[64]?d[65]=!1:d[65]=!0,d[65]?0:(d[64]?d[120]=!1:d[120]=!0,d[120]?d[121]=void 0:(d[122]=new c.Map(),d[126]="has_previous_perm_prompt",d[123]=d[64].get(d[126]),d[123]!==void 0?d[122].set(d[126],d[123]):0,d[127]="latitude",d[124]=d[64].get(d[127]),d[124]!==void 0?d[122].set(d[127],d[124]):0,d[128]="longitude",d[125]=d[64].get(d[128]),d[125]!==void 0?d[122].set(d[128],d[125]):0,d[121]=d[122]),d[58].set(d[99],d[121])),d[100]="qpl_join_id",d[66]=d[41].get(d[100]),d[66]!==void 0?d[58].set(d[100],d[66]):0,d[101]="meta_ai_prompt_type",d[67]=d[41].get(d[101]),d[67]!==void 0?d[58].set(d[101],d[67]):0,d[102]="is_subsequent_send",d[68]=d[41].get(d[102]),d[68]!==void 0?d[58].set(d[102],d[68]):0,d[103]="context_injection_type",d[69]=d[41].get(d[103]),d[69]!==void 0?d[58].set(d[103],d[69]):0,d[104]="context_injection_timestamp_ms",d[70]=d[41].get(d[104]),d[70]!==void 0?d[58].set(d[104],d[70]):0,d[105]="meta_ai_response_to_persist",d[71]=d[41].get(d[105]),d[71]?d[72]=!1:d[72]=!0,d[72]?c.resolve():c.sequence([function(a){return d[71]?d[120]=!1:d[120]=!0,d[120]?c.resolve(d[121]=void 0):c.sequence([function(a){return d[122]=new c.Map(),d[129]="text",d[123]=d[71].get(d[129]),d[123]!==void 0?d[122].set(d[129],d[123]):0,d[130]="bot_response_id",d[124]=d[71].get(d[130]),d[124]!==void 0?d[122].set(d[130],d[124]):0,d[131]="bot_request_id",d[125]=d[71].get(d[131]),d[125]!==void 0?d[122].set(d[131],d[125]):0,d[132]="external_search_params",d[126]=d[71].get(d[132]),d[126]?d[127]=!1:d[127]=!0,d[127]?c.resolve():c.sequence([function(a){return d[126]?d[134]=!1:d[134]=!0,d[134]?c.resolve(d[135]=void 0):c.sequence([function(a){return d[136]=new c.Map(),d[144]="search_result_uri",d[137]=d[126].get(d[144]),d[137]?d[138]=!1:d[138]=!0,d[138]?c.resolve():c.sequence([function(a){return d[137]?d[149]=!1:d[149]=!0,d[149]?c.resolve(d[150]=void 0):c.sequence([function(a){return d[151]=c.createArray(),d[152]=c.i64.of_int32(d[137].length),c.i64.gt(d[152],c.i64.cast([0,0]))?c.loopAsync(d[152],function(a){return d[153]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[137],d[153]).then(function(a){return a=a,d[154]=a[0],d[155]=a[1],a})},function(a){return d[156]=(d[151].push(d[154]),d[151])}])}):c.resolve()},function(a){return d[150]=d[151]}])},function(a){return d[136].set(d[144],d[150])}])},function(a){return d[145]="search_query",d[139]=d[126].get(d[145]),d[139]!==void 0?d[136].set(d[145],d[139]):0,d[146]="attribution_link",d[140]=d[126].get(d[146]),d[140]!==void 0?d[136].set(d[146],d[140]):0,d[147]="search_engine",d[141]=d[126].get(d[147]),d[141]!==void 0?d[136].set(d[147],d[141]):0,d[148]="references_title",d[142]=d[126].get(d[148]),d[142]?d[143]=!1:d[143]=!0,d[143]?c.resolve():c.sequence([function(a){return d[142]?d[149]=!1:d[149]=!0,d[149]?c.resolve(d[150]=void 0):c.sequence([function(a){return d[151]=c.createArray(),d[152]=c.i64.of_int32(d[142].length),c.i64.gt(d[152],c.i64.cast([0,0]))?c.loopAsync(d[152],function(a){return d[153]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[142],d[153]).then(function(a){return a=a,d[154]=a[0],d[155]=a[1],a})},function(a){return d[156]=(d[151].push(d[154]),d[151])}])}):c.resolve()},function(a){return d[150]=d[151]}])},function(a){return d[136].set(d[148],d[150])}])},function(a){return d[135]=d[136]}])},function(a){return d[122].set(d[132],d[135])}])},function(a){return d[133]="followup_prompt_text",d[128]=d[71].get(d[133]),d[128]!==void 0?d[122].set(d[133],d[128]):0,d[121]=d[122]}])},function(a){return d[58].set(d[105],d[121])}])},function(a){return d[106]="gql_dark_test_qpl_join_id",d[73]=d[41].get(d[106]),d[73]!==void 0?d[58].set(d[106],d[73]):0,d[107]="gql_dark_test_client_start_time",d[74]=d[41].get(d[107]),d[74]!==void 0?d[58].set(d[107],d[74]):0,d[108]="prompt_context",d[75]=d[41].get(d[108]),d[75]?d[76]=!1:d[76]=!0,d[76]?0:(d[75]?d[120]=!1:d[120]=!0,d[120]?d[121]=void 0:(d[122]=new c.Map(),d[125]="context_token",d[123]=d[75].get(d[125]),d[123]!==void 0?d[122].set(d[125],d[123]):0,d[126]="context_token_type",d[124]=d[75].get(d[126]),c.i64.neq(d[124],void 0)?d[122].set(d[126],d[124]):0,d[121]=d[122]),d[58].set(d[108],d[121])),d[109]="imagine_flash_extras",d[77]=d[41].get(d[109]),d[77]?d[78]=!1:d[78]=!0,d[78]?0:(d[77]?d[120]=!1:d[120]=!0,d[120]?d[121]=void 0:(d[122]=new c.Map(),d[125]="seed",d[123]=d[77].get(d[125]),c.i64.neq(d[123],void 0)?d[122].set(d[125],d[123]):0,d[126]="qpl_join_id",d[124]=d[77].get(d[126]),d[124]!==void 0?d[122].set(d[126],d[124]):0,d[121]=d[122]),d[58].set(d[109],d[121])),d[110]="conversation_marker_id",d[79]=d[41].get(d[110]),d[79]!==void 0?d[58].set(d[110],d[79]):0,d[111]="multi_modal_extras",d[80]=d[41].get(d[111]),d[80]?d[81]=!1:d[81]=!0,d[81]?0:(d[80]?d[120]=!1:d[120]=!0,d[120]?d[121]=void 0:(d[122]=new c.Map(),d[126]="should_skip_genai_eval",d[123]=d[80].get(d[126]),d[123]!==void 0?d[122].set(d[126],d[123]):0,d[127]="associated_multimodal_message_id",d[124]=d[80].get(d[127]),d[124]!==void 0?d[122].set(d[127],d[124]):0,d[128]="qpl_join_id",d[125]=d[80].get(d[128]),d[125]!==void 0?d[122].set(d[128],d[125]):0,d[121]=d[122]),d[58].set(d[111],d[121])),d[112]="ads_extras",d[82]=d[41].get(d[112]),d[82]?d[83]=!1:d[83]=!0,d[83]?0:(d[82]?d[120]=!1:d[120]=!0,d[120]?d[121]=void 0:(d[122]=new c.Map(),d[126]="context",d[123]=d[82].get(d[126]),d[123]!==void 0?d[122].set(d[126],d[123]):0,d[127]="is_reply_to_ads_ai",d[124]=d[82].get(d[127]),d[124]!==void 0?d[122].set(d[127],d[124]):0,d[128]="is_message_processed_by_lightspeed",d[125]=d[82].get(d[128]),d[125]!==void 0?d[122].set(d[128],d[125]):0,d[121]=d[122]),d[58].set(d[112],d[121])),d[113]="suggested_prompt_extras",d[84]=d[41].get(d[113]),d[84]?d[85]=!1:d[85]=!0,d[85]?0:(d[84]?d[120]=!1:d[120]=!0,d[120]?d[121]=void 0:(d[122]=new c.Map(),d[125]="prompt_type",d[123]=d[84].get(d[125]),d[123]!==void 0?d[122].set(d[125],d[123]):0,d[126]="qpl_join_id",d[124]=d[84].get(d[126]),d[124]!==void 0?d[122].set(d[126],d[124]):0,d[121]=d[122]),d[58].set(d[113],d[121])),d[114]="disable_server_mqtt_typing_indicator",d[86]=d[41].get(d[114]),d[86]!==void 0?d[58].set(d[114],d[86]):0,d[115]="enable_web_scraping",d[87]=d[41].get(d[115]),d[87]!==void 0?d[58].set(d[115],d[87]):0,d[116]="client_prompt_timestamp",d[88]=d[41].get(d[116]),d[88]!==void 0?(d[88]!==void 0?d[120]=c.i64.from_string(d[88]):d[120]=void 0,d[58].set(d[116],d[120])):0,d[117]="is_client_ready_for_psi",d[89]=d[41].get(d[117]),d[89]!==void 0?d[58].set(d[117],d[89]):0,d[118]="intent_detection_extras",d[90]=d[41].get(d[118]),d[90]?d[91]=!1:d[91]=!0,d[91]?c.resolve():c.sequence([function(a){return d[90]?d[120]=!1:d[120]=!0,d[120]?c.resolve(d[121]=void 0):c.sequence([function(a){return d[122]=new c.Map(),d[131]="intent_messages_metadata",d[123]=d[90].get(d[131]),d[123]?d[124]=!1:d[124]=!0,d[124]?c.resolve():c.sequence([function(a){return d[123]?d[135]=!1:d[135]=!0,d[135]?c.resolve(d[136]=void 0):c.sequence([function(a){return d[137]=c.createArray(),d[138]=c.i64.of_int32(d[123].length),c.i64.gt(d[138],c.i64.cast([0,0]))?c.loopAsync(d[138],function(a){return d[139]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[123],d[139]).then(function(a){return a=a,d[140]=a[0],d[141]=a[1],a})},function(a){return d[142]=new c.Map(),d[150]="message_type",d[143]=d[140].get(d[150]),d[143]!==void 0?d[142].set(d[150],d[143]):0,d[151]="message_sender_name",d[144]=d[140].get(d[151]),d[144]!==void 0?d[142].set(d[151],d[144]):0,d[152]="message_invoker_name",d[145]=d[140].get(d[152]),d[145]!==void 0?d[142].set(d[152],d[145]):0,d[153]="message_timestamp_ms",d[146]=d[140].get(d[153]),d[146]!==void 0?d[142].set(d[153],c.i64.from_string(d[146])):0,d[154]="message_thread_name",d[147]=d[140].get(d[154]),d[147]!==void 0?d[142].set(d[154],d[147]):0,d[155]="message_id",d[148]=d[140].get(d[155]),d[148]!==void 0?d[142].set(d[155],d[148]):0,d[156]="message_text",d[149]=d[140].get(d[156]),d[149]!==void 0?d[142].set(d[156],d[149]):0,d[157]=(d[137].push(d[142]),d[137])}])}):c.resolve()},function(a){return d[136]=d[137]}])},function(a){return d[122].set(d[131],d[136])}])},function(a){return d[132]="intent_types",d[125]=d[90].get(d[132]),d[125]?d[126]=!1:d[126]=!0,d[126]?c.resolve():c.sequence([function(a){return d[125]?d[135]=!1:d[135]=!0,d[135]?c.resolve(d[136]=void 0):c.sequence([function(a){return d[137]=c.createArray(),d[138]=c.i64.of_int32(d[125].length),c.i64.gt(d[138],c.i64.cast([0,0]))?c.loopAsync(d[138],function(a){return d[139]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[125],d[139]).then(function(a){return a=a,d[140]=a[0],d[141]=a[1],a})},function(a){return d[142]=(d[137].push(d[140]),d[137])}])}):c.resolve()},function(a){return d[136]=d[137]}])},function(a){return d[122].set(d[132],d[136])}])},function(a){return d[133]="intent_message_ids",d[127]=d[90].get(d[133]),d[127]?d[128]=!1:d[128]=!0,d[128]?c.resolve():c.sequence([function(a){return d[127]?d[135]=!1:d[135]=!0,d[135]?c.resolve(d[136]=void 0):c.sequence([function(a){return d[137]=c.createArray(),d[138]=c.i64.of_int32(d[127].length),c.i64.gt(d[138],c.i64.cast([0,0]))?c.loopAsync(d[138],function(a){return d[139]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[127],d[139]).then(function(a){return a=a,d[140]=a[0],d[141]=a[1],a})},function(a){return d[142]=(d[137].push(d[140]),d[137])}])}):c.resolve()},function(a){return d[136]=d[137]}])},function(a){return d[122].set(d[133],d[136])}])},function(a){return d[134]="intent_messages",d[129]=d[90].get(d[134]),d[129]?d[130]=!1:d[130]=!0,d[130]?c.resolve():c.sequence([function(a){return d[129]?d[135]=!1:d[135]=!0,d[135]?c.resolve(d[136]=void 0):c.sequence([function(a){return d[137]=c.createArray(),d[138]=c.i64.of_int32(d[129].length),c.i64.gt(d[138],c.i64.cast([0,0]))?c.loopAsync(d[138],function(a){return d[139]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[129],d[139]).then(function(a){return a=a,d[140]=a[0],d[141]=a[1],a})},function(a){return d[142]=(d[137].push(d[140]),d[137])}])}):c.resolve()},function(a){return d[136]=d[137]}])},function(a){return d[122].set(d[134],d[136])}])},function(a){return d[121]=d[122]}])},function(a){return d[58].set(d[118],d[121])}])},function(a){return d[119]="psi_tool_query_data",d[92]=d[41].get(d[119]),d[92]?d[93]=!1:d[93]=!0,d[93]?c.resolve():c.sequence([function(a){return d[92]?d[120]=!1:d[120]=!0,d[120]?c.resolve(d[121]=void 0):c.sequence([function(a){return d[122]=new c.Map(),d[128]="conversation_name",d[123]=d[92].get(d[128]),d[123]!==void 0?d[122].set(d[128],d[123]):0,d[129]="original_query_string",d[124]=d[92].get(d[129]),d[124]!==void 0?d[122].set(d[129],d[124]):0,d[130]="response_message_id",d[125]=d[92].get(d[130]),d[125]!==void 0?d[122].set(d[130],d[125]):0,d[131]="messages",d[126]=d[92].get(d[131]),d[126]?d[127]=!1:d[127]=!0,d[127]?c.resolve():c.sequence([function(a){return d[126]?d[132]=!1:d[132]=!0,d[132]?c.resolve(d[133]=void 0):c.sequence([function(a){return d[134]=c.createArray(),d[135]=c.i64.of_int32(d[126].length),c.i64.gt(d[135],c.i64.cast([0,0]))?c.loopAsync(d[135],function(a){return d[136]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[126],d[136]).then(function(a){return a=a,d[137]=a[0],d[138]=a[1],a})},function(a){return d[139]=new c.Map(),d[147]="message_type",d[140]=d[137].get(d[147]),d[140]!==void 0?d[139].set(d[147],d[140]):0,d[148]="message_sender_name",d[141]=d[137].get(d[148]),d[141]!==void 0?d[139].set(d[148],d[141]):0,d[149]="message_invoker_name",d[142]=d[137].get(d[149]),d[142]!==void 0?d[139].set(d[149],d[142]):0,d[150]="message_timestamp_ms",d[143]=d[137].get(d[150]),d[143]!==void 0?d[139].set(d[150],c.i64.from_string(d[143])):0,d[151]="message_thread_name",d[144]=d[137].get(d[151]),d[144]!==void 0?d[139].set(d[151],d[144]):0,d[152]="message_id",d[145]=d[137].get(d[152]),d[145]!==void 0?d[139].set(d[152],d[145]):0,d[153]="message_text",d[146]=d[137].get(d[153]),d[146]!==void 0?d[139].set(d[153],d[146]):0,d[154]=(d[134].push(d[139]),d[134])}])}):c.resolve()},function(a){return d[133]=d[134]}])},function(a){return d[122].set(d[131],d[133])}])},function(a){return d[121]=d[122]}])},function(a){return d[58].set(d[119],d[121])}])},function(a){return d[57]=d[58]}]):c.sequence([function(a){return d[48]==="XMSGProductHighlightExtras"?c.resolve((d[59]=new c.Map(),d[62]="product_highlight_type",d[60]=d[41].get(d[62]),d[60]!==void 0?d[59].set(d[62],d[60]):0,d[63]="conversation_marker",d[61]=d[41].get(d[63]),d[61]!==void 0?d[59].set(d[63],d[61]):0,d[58]=d[59])):c.sequence([function(a){return d[48]==="XMSGMagicMessengerExtras"?c.resolve((d[60]=new c.Map(),d[62]="is_magic_thread",d[61]=d[41].get(d[62]),d[61]!==void 0?d[60].set(d[62],d[61]):0,d[59]=d[60])):c.sequence([function(a){return d[48]==="XMSGAdsAIExtras"?c.resolve((d[61]=new c.Map(),d[65]="context",d[62]=d[41].get(d[65]),d[62]!==void 0?d[61].set(d[65],d[62]):0,d[66]="is_reply_to_ads_ai",d[63]=d[41].get(d[66]),d[63]!==void 0?d[61].set(d[66],d[63]):0,d[67]="is_message_processed_by_lightspeed",d[64]=d[41].get(d[67]),d[64]!==void 0?d[61].set(d[67],d[64]):0,d[60]=d[61])):c.sequence([function(a){return d[48]==="XMSGBizappExtras"?c.resolve((d[62]=new c.Map(),d[65]="message_source",d[63]=d[41].get(d[65]),d[63]!==void 0?d[62].set(d[65],d[63]):0,d[66]="message_trigger",d[64]=d[41].get(d[66]),d[64]!==void 0?d[62].set(d[66],d[64]):0,d[61]=d[62])):c.sequence([function(a){return d[62]=new c.Map(),d[63]=d[41].keys(),d[64]=c.i64.of_int32(d[63].length),c.i64.gt(d[64],c.i64.cast([0,0]))?c.loopAsync(d[64],function(a){return d[65]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[63],d[65]).then(function(a){return a=a,d[66]=a[0],d[67]=a[1],a})},function(a){return d[68]=d[41].get(d[66]),d[62].set(d[66],d[68])}])}):c.resolve()},function(a){return d[61]=d[62]}])},function(a){return d[60]=d[61]}])},function(a){return d[59]=d[60]}])},function(a){return d[58]=d[59]}])},function(a){return d[57]=d[58]}])},function(a){return d[56]=d[57]}])},function(a){return d[55]=d[56]}])},function(a){return d[54]=d[55]}])},function(a){return d[53]=d[54]}])},function(a){return d[52]=d[53]}])},function(a){return d[51]=d[52]}])},function(a){return d[50]=d[51]}])},function(a){return d[49]=d[50]}])},function(a){return d[49].set("__typename",d[48]),d[47]=d[49]}])},function(a){return d[39].set(d[45],d[47])}])},function(a){return d[43]=d[39].get("product_extras"),d[43]!==void 0?(d[46]=d[43].get("__typename"),d[46]==="XMSGClickToMessengerAdExtras"?(d[48]=new c.Map(),d[59]="encrypted_ads_token",d[49]=d[43].get(d[59]),d[49]!==void 0?d[48].set(d[59],d[49]):0,d[60]="product_type",d[50]=d[43].get(d[60]),d[50]!==void 0?d[48].set(d[60],d[50]):0,d[61]="post_id",d[51]=d[43].get(d[61]),d[51]!==void 0?d[48].set(d[61],d[51]):0,d[62]="ad_id",d[52]=d[43].get(d[62]),d[52]!==void 0?d[48].set(d[62],d[52]):0,d[63]="page_id",d[53]=d[43].get(d[63]),d[53]!==void 0?d[48].set(d[63],d[53]):0,d[64]="photo_id",d[54]=d[43].get(d[64]),d[54]!==void 0?d[48].set(d[64],d[54]):0,d[65]="photo_index",d[55]=d[43].get(d[65]),c.i64.neq(d[55],void 0)?d[48].set(d[65],d[55]):0,d[66]="fallback_url",d[56]=d[43].get(d[66]),d[56]!==void 0?d[48].set(d[66],d[56]):0,d[67]="product_id",d[57]=d[43].get(d[67]),d[57]!==void 0?d[48].set(d[67],d[57]):0,d[68]="user_id",d[58]=d[43].get(d[68]),d[58]!==void 0?d[48].set(d[68],d[58]):0,d[47]=d[48]):d[47]=void 0,d[47]!==void 0?(d[48]=new c.Map(),d[48].set("product_extras",d[47]),d[48].set("client_thread_key",d[37]),d[48].set("offline_threading_id",c.i64.to_string(d[34])),d[48].set("admin_text_otid",c.i64.to_string(d[36])),d[49]=d[48].get("client_thread_key"),d[50]=c.toJSON(d[48]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[49]),c.i64.cast([0,1020]),d[50],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.resolve()):c.resolve()}]):c.resolve()}]):c.resolve()},function(e){return c.i64.eq(d[24],c.i64.cast([0,20]))&&!1&&!1?c.sequence([function(e){return c.storedProcedure(b("LSCreateGroupThreadWithAdminText"),d[14],void 0,a[2],void 0).then(function(a){return a=a,d[30]=a[0],a})},function(a){return a=[d[30],c.i64.cast([0,80])],d[28]=a[0],d[29]=a[1],a}]):c.sequence([function(e){return c.i64.eq(a[1],c.i64.cast([0,5]))?c.sequence([function(e){return c.storedProcedure(b("LSVerifyThreadRowExistsV2"),d[22],a[1],c.i64.cast([0,1]),c.i64.cast([0,20]))},function(a){return d[30]=c.i64.cast([0,20])}]):c.sequence([function(e){return c.i64.eq(d[24],c.i64.cast([0,80]))&&!1&&!1?d[31]=d[24]:d[31]=c.i64.cast([0,40]),c.storedProcedure(b("LSVerifyThreadRowExists"),d[22],a[1],c.i64.cast([0,1]))},function(a){return d[30]=d[31]}])},function(a){return a=[d[22],d[30]],d[28]=a[0],d[29]=a[1],a}])},function(a){return a=[d[28],d[29]],d[26]=a[0],d[27]=a[1],a}]):c.sequence([function(e){return d[36]=c.i64.of_int32(a[6].length),c.i64.gt(d[36],c.i64.cast([0,0]))?c.loopAsync(d[36],function(e){return d[37]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[6],d[37]).then(function(a){return a=a,d[38]=a[0],d[39]=a[1],a})},function(a){return d[40]=d[38].get("contact_id"),d[41]=d[38].get("contact_type"),d[42]=d[38].get("contact_name"),d[43]=d[38].get("contact_profile_photo"),c.storedProcedure(b("LSVerifyContactRowExists"),d[40],c.i64.cast([0,0]),d[43],d[42],d[41],void 0,void 0,void 0,void 0,!1,!1,c.i64.cast([0,0]),void 0,!1,c.i64.cast([0,20]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,2]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,5]))}])}):c.resolve()},function(e){return void 0?d[28]=!1:d[28]=!0,d[28]?(e=["",void 0,void 0,void 0,void 0],d[29]=e[0],d[30]=e[1],d[31]=e[2],d[32]=e[3],d[33]=e[4],e):(d[36]=(void 0).get("nullstate_description_text1"),d[36]!==void 0?d[37]=d[36]:d[37]="",d[38]=(void 0).get("nullstate_description_text2"),d[39]=(void 0).get("nullstate_description_text3"),d[40]=(void 0).get("nullstate_description_text4"),d[41]=(void 0).get("nullstate_description_text5"),e=[d[37],d[38],d[39],d[40],d[41]],d[29]=e[0],d[30]=e[1],d[31]=e[2],d[32]=e[3],d[33]=e[4]),c.sequence([function(e){return d[36]=new c.Map(),d[36].set("nullstate_description_text1",d[29]),d[36].set("nullstate_description_text2",d[30]),d[36].set("nullstate_description_text3",d[31]),d[36].set("nullstate_description_text4",d[32]),d[36].set("nullstate_description_text5",d[33]),c.storedProcedure(b("LSLocalCreateOptimisticGroupThread"),d[14],"",a[2],!0,a[8]).then(function(a){return a=a,d[37]=a[0],a})},function(a){return c.storedProcedure(b("LSInsertNewMessageRange"),d[37],c.i64.cast([0,0]),c.i64.cast([2328,1316134911]),"","",c.i64.cast([0,0]),c.i64.cast([0,0]),!1,!1,void 0)},function(a){return a=[d[37],void 0],d[34]=a[0],d[35]=a[1],a}])},function(a){return a=[d[34],d[35]],d[26]=a[0],d[27]=a[1],a}])},function(a){return a=[d[26],d[27]],d[12]=a[0],d[13]=a[1],a}]):c.sequence([function(e){return[c.i64.cast([0,19]),c.i64.cast([0,28])].some(function(b){return c.i64.eq(a[1],b)})?c.sequence([function(e){return d[16]=new c.Map(),d[16].set("thread_fbid",a[0]),d[16].set("force_upsert",!1),d[16].set("use_open_messenger_transport",!1),d[16].set("sync_group",c.i64.cast([0,104])),d[16].set("metadata_only",!1),d[16].set("preview_only",!0),d[17]=d[16].get("thread_fbid"),d[18]=c.toJSON(d[16]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[17]),c.i64.cast([0,209]),d[18],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(b){return b=[a[0],void 0],d[14]=b[0],d[15]=b[1],b}]):c.sequence([function(d){return c.i64.eq(a[1],c.i64.cast([0,5]))?c.storedProcedure(b("LSVerifyThreadRowExistsV2"),a[0],a[1],c.i64.cast([0,1]),c.i64.cast([0,20])):c.storedProcedure(b("LSVerifyThreadRowExists"),a[0],a[1],c.i64.cast([0,1]))},function(e){return c.i64.lt(d[5],c.i64.cast([0,60]))?c.storedProcedure(b("LSInsertNewMessageRange"),a[0],c.i64.cast([0,0]),c.i64.cast([2328,1316134911]),"","",c.i64.cast([0,0]),c.i64.cast([0,0]),!1,!1,void 0):c.resolve()},function(b){return b=[a[0],void 0],d[14]=b[0],d[15]=b[1],b}])},function(a){return a=[d[14],d[15]],d[12]=a[0],d[13]=a[1],a}])},function(a){return a=[d[12],d[13]],d[7]=a[0],d[8]=a[1],a}])},function(e){return c.i64.eq(d[8]==null?d[5]:d[8],c.i64.cast([0,20]))?c.sequence([function(e){return c.i64.neq(a[4],void 0)?c.resolve(d[12]=a[4]):c.sequence([function(a){return c.storedProcedure(b("LSComputeOptimisticThreadCapabilities"),d[7]).then(function(a){return a=a,d[13]=a[0],a})},function(a){return d[12]=d[13]}])},function(a){return c.forEach(c.db.table(9).fetch([[[d[7]]]]),function(a){var b=a.update;a.item;return b({capabilities:d[12]})})}]):c.resolve()},function(a){return c.db.table(9).fetch([[[d[7]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(e=[d[7],c.i64.cast([0,0])],d[9]=e[0],d[10]=e[1],e):(b=a.item,b.isDisappearingMode?(e=[b.disappearingThreadKey,c.i64.cast([0,1024])],d[12]=e[0],d[13]=e[1],e):(a=[d[7],b.mailboxType],d[12]=a[0],d[13]=a[1],a),e=[d[12],d[13]],d[9]=e[0],d[10]=e[1])})},function(a){return a=[d[9],d[10]],d[1]=a[0],d[2]=a[1],a}])},function(a){return a=[d[1],d[2]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxVerifyThreadViewStoredProcedure";a.__tables__=["threads","participants"];e.exports=a}),null);
__d("LSVerifyThreadViewStoredProcedure",["LSSynchronousPromise","LSVerifyThreadView","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSVerifyThreadView"),e.threadKey,e.threadType,e.threadName,e.threadPictureUrl,e.threadCapabilities,e.messageId,e.contacts,e.mailboxType,e.threadMetadata,e.enableCcThreadMetadataFix);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWDeleteAllDBs",["MAWEncryptionIndexedDbV2","MAWIndexedDBDeletion","asyncToGeneratorRuntime","cr:10030"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){b("cr:10030")&&(yield b("cr:10030").deleteIndexedDB(a)),yield d("MAWIndexedDBDeletion").deleteMAWPersistence(),(c==null?void 0:c.deleteEncryptionDB)===!0&&(yield d("MAWEncryptionIndexedDbV2").deleteEncryptionDB_UNSAFE(void 0,"delete_all_dbs"))});return h.apply(this,arguments)}g.deleteAllDBs_DO_NOT_USE_UNLESS_YOU_KNOW_WHAT_YOU_ARE_DOING=a}),98);
__d("MAWEncryptionErrorHandler",["FBLogger","MAWSetupWorker","MWDeleteAllDBs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a="MAWEARKeychainDecryptionError",b="error";try{yield d("MAWSetupWorker").terminateWorker(a);return d("MWDeleteAllDBs").deleteAllDBs_DO_NOT_USE_UNLESS_YOU_KNOW_WHAT_YOU_ARE_DOING(b,{deleteEncryptionDB:!0})}catch(d){c("FBLogger")("messenger_web").catching(d).mustfixThrow("Fail to delete dbs from: %s terminateWorkerReason: %s",b,a)}});return h.apply(this,arguments)}g.handleEARKeychainError=a}),98);
__d("MWFocusTable.react",["FocusTable.react","focusScopeQueries"],(function(a,b,c,d,e,f,g){"use strict";g.createFocusTable=d("FocusTable.react").createFocusTable,g.tabbableScopeQuery=d("focusScopeQueries").tabbableScopeQuery}),98);
__d("MWXPopoverLoadingState.react",["cr:8235"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:8235")}),98);
__d("mwEBCheckIfEBKeysExistInDisk",["EBDB","FBLogger","MWChatEncryptedBackupsQPLEvents","Promise","QPLUserFlow","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("gkx")("415");function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!j||a==="true")return(i||(i=b("Promise"))).resolve();try{a=(yield d("EBDB").getEBDB());a=(yield a.store("secure_encrypted_backups_client_state").count());c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{has_eb_keys_on_disk:(a>0).toString()}})}catch(a){c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{has_eb_keys_on_disk:"failed_to_open_db"}});c("FBLogger")("labyrinth_web").MUSTFIX(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to check if EB keys exists, ",""])),a);throw a}});return k.apply(this,arguments)}g["default"]=a}),98);